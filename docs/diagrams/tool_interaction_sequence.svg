<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="6520px" preserveAspectRatio="none" style="width:2871px;height:6520px;background:#FFFFFF;" version="1.1" viewBox="0 0 2871 6520" width="2871px" zoomAndPan="magnify"><title>Tool Interaction Sequence - Pen Tool and Selection Tool Workflows</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="486.165" x="1188.6211" y="28.5352">Tool Interaction Sequence - Pen Tool and Selection Tool Workflows</text><rect fill="#E0FFFF" height="6470.9551" style="stroke:#181818;stroke-width:0.5;" width="310.9741" x="708.8662" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="37.1528" x="845.7769" y="56.0566">Tools</text><rect fill="#ADD8E6" height="6470.9551" style="stroke:#181818;stroke-width:0.5;" width="516.6533" x="1183.8716" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="189.0078" x="1347.6943" y="56.0566">Event Recording &amp; Sampling</text><rect fill="#90EE90" height="6470.9551" style="stroke:#181818;stroke-width:0.5;" width="345.4346" x="1770.1797" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="113.9912" x="1885.9014" y="56.0566">Event Processing</text><rect fill="#FFFFE0" height="6470.9551" style="stroke:#181818;stroke-width:0.5;" width="395.668" x="2267.2988" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="129.6636" x="2400.301" y="56.0566">Persistence &amp; Undo</text><rect fill="none" height="605.5215" style="stroke:#000000;stroke-width:1.5;" width="2839.4072" x="15" y="449.3926"/><rect fill="none" height="359.0371" style="stroke:#000000;stroke-width:1.5;" width="2839.4072" x="15" y="2991.4102"/><rect fill="none" height="359.0371" style="stroke:#000000;stroke-width:1.5;" width="2839.4072" x="15" y="3792.7949"/><rect fill="none" height="200.4844" style="stroke:#000000;stroke-width:1.5;" width="1193.3198" x="1177.8716" y="4349.0059"/><rect fill="none" height="118.2422" style="stroke:#000000;stroke-width:1.5;" width="581.0093" x="1571.0454" y="5564.2227"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="39.1826" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="43" x2="43" y1="118.9766" y2="6434.9551"/></g><g><title>Canvas Widget</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="268.9546" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="272.3291" x2="272.3291" y1="118.9766" y2="6434.9551"/></g><g><title>Tool Manager</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="582.3633" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="585.8652" x2="585.8652" y1="118.9766" y2="6434.9551"/></g><g><title>Pen Tool</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="745.2437" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="748.8662" x2="748.8662" y1="118.9766" y2="6434.9551"/></g><g><title>Direct Selection</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="951.9268" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="955.0132" x2="955.0132" y1="118.9766" y2="6434.9551"/></g><g><title>Event Sampler</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="1238.73" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1241.8716" x2="1241.8716" y1="118.9766" y2="6434.9551"/></g><g><title>Event Recorder</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="1634.7852" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1638.0454" x2="1638.0454" y1="118.9766" y2="6434.9551"/></g><g><title>Event Dispatcher</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="1834.0923" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1837.1797" x2="1837.1797" y1="118.9766" y2="6434.9551"/></g><g><title>Document State</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="2046.7573" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2049.9004" x2="2049.9004" y1="118.9766" y2="6434.9551"/></g><g><title>Event Store</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="2312.2451" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2315.2988" x2="2315.2988" y1="118.9766" y2="6434.9551"/></g><g><title>Snapshot Manager</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="2585.3018" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2588.6367" x2="2588.6367" y1="118.9766" y2="6434.9551"/></g><g><title>Canvas Renderer</title><rect fill="#000000" fill-opacity="0.00000" height="6315.9785" width="8" x="2776.4775" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2779.5479" x2="2779.5479" y1="118.9766" y2="6434.9551"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="25" y="116.0234">User</text><ellipse cx="43.1826" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43.1826,58.9883 L43.1826,85.9883 M30.1826,66.9883 L56.1826,66.9883 M43.1826,85.9883 L30.1826,100.9883 M43.1826,85.9883 L56.1826,100.9883" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="25" y="6447.4902">User</text><ellipse cx="43.1826" cy="6458.9434" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43.1826,6466.9434 L43.1826,6493.9434 M30.1826,6474.9434 L56.1826,6474.9434 M43.1826,6493.9434 L30.1826,6508.9434 M43.1826,6493.9434 L56.1826,6508.9434" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Canvas"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.251" x="216.3291" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.251" x="223.3291" y="108.0234">Canvas Widget</text></g><g class="participant participant-tail" data-participant="Canvas"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.251" x="216.3291" y="6433.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.251" x="223.3291" y="6454.4902">Canvas Widget</text></g><g class="participant participant-head" data-participant="ToolMgr"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.9961" x="532.8652" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.9961" x="539.8652" y="108.0234">Tool Manager</text></g><g class="participant participant-tail" data-participant="ToolMgr"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.9961" x="532.8652" y="6433.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.9961" x="539.8652" y="6454.4902">Tool Manager</text></g><g class="participant participant-head" data-participant="PenTool"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="72.7549" x="712.8662" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.7549" x="719.8662" y="108.0234">Pen Tool</text></g><g class="participant participant-tail" data-participant="PenTool"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="72.7549" x="712.8662" y="6433.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.7549" x="719.8662" y="6454.4902">Pen Tool</text></g><g class="participant participant-head" data-participant="DirectSel"><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119.8271" x="896.0132" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.8271" x="903.0132" y="91.5352">Direct Selection</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.0986" x="940.8774" y="108.0234">Tool</text></g><g class="participant participant-tail" data-participant="DirectSel"><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119.8271" x="896.0132" y="6433.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.8271" x="903.0132" y="6454.4902">Direct Selection</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.0986" x="940.8774" y="6470.9785">Tool</text></g><g class="participant participant-head" data-participant="Sampler"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109.7168" x="1187.8716" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.7168" x="1194.8716" y="108.0234">Event Sampler</text></g><g class="participant participant-tail" data-participant="Sampler"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109.7168" x="1187.8716" y="6433.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.7168" x="1194.8716" y="6454.4902">Event Sampler</text></g><g class="participant participant-head" data-participant="Recorder"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.4795" x="1581.0454" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.4795" x="1588.0454" y="108.0234">Event Recorder</text></g><g class="participant participant-tail" data-participant="Recorder"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.4795" x="1581.0454" y="6433.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.4795" x="1588.0454" y="6454.4902">Event Recorder</text></g><g class="participant participant-head" data-participant="Dispatcher"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.8252" x="1774.1797" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.8252" x="1781.1797" y="108.0234">Event Dispatcher</text></g><g class="participant participant-tail" data-participant="Dispatcher"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.8252" x="1774.1797" y="6433.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.8252" x="1781.1797" y="6454.4902">Event Dispatcher</text></g><g class="participant participant-head" data-participant="Doc"><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121.7139" x="1989.9004" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.7139" x="1996.9004" y="91.5352">Document State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.5938" x="2009.9604" y="108.0234">(Immutable)</text></g><g class="participant participant-tail" data-participant="Doc"><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121.7139" x="1989.9004" y="6433.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.7139" x="1996.9004" y="6454.4902">Document State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.5938" x="2009.9604" y="6470.9785">(Immutable)</text></g><g class="participant participant-head" data-participant="EventStore"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89.8926" x="2271.2988" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.8926" x="2278.2988" y="108.0234">Event Store</text></g><g class="participant participant-tail" data-participant="EventStore"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89.8926" x="2271.2988" y="6433.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.8926" x="2278.2988" y="6454.4902">Event Store</text></g><g class="participant participant-head" data-participant="SnapMgr"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139.3301" x="2519.6367" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.3301" x="2526.6367" y="108.0234">Snapshot Manager</text></g><g class="participant participant-tail" data-participant="SnapMgr"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139.3301" x="2519.6367" y="6433.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.3301" x="2526.6367" y="6454.4902">Snapshot Manager</text></g><g class="participant participant-head" data-participant="Renderer"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.8594" x="2716.5479" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.8594" x="2723.5479" y="108.0234">Canvas Renderer</text></g><g class="participant participant-tail" data-participant="Renderer"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.8594" x="2716.5479" y="6433.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.8594" x="2723.5479" y="6454.4902">Canvas Renderer</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2864.4072" x="0" y="149.6318"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2864.4072" y1="149.6318" y2="149.6318"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2864.4072" y1="152.6318" y2="152.6318"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="186.6689" x="1338.8691" y="138.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168.3843" x="1344.8691" y="155.5449">Pen Tool: Creating a Path</text><g class="message" data-participant-1="User" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,189.5977,584.3633,193.5977,574.3633,197.5977,578.3633,193.5977" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="580.3633" y1="193.5977" y2="193.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.9321" x="50.1826" y="188.8555">Activate Pen Tool</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="PenTool"><polygon fill="#181818" points="737.2437,218.9082,747.2437,222.9082,737.2437,226.9082,741.2437,222.9082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="743.2437" y1="222.9082" y2="222.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.769" x="593.3633" y="218.166">onActivate()</text></g><g class="message" data-participant-1="PenTool" data-participant-2="PenTool"><line style="stroke:#181818;stroke-width:1;" x1="749.2437" x2="791.2437" y1="252.2188" y2="252.2188"/><line style="stroke:#181818;stroke-width:1;" x1="791.2437" x2="791.2437" y1="252.2188" y2="265.2188"/><line style="stroke:#181818;stroke-width:1;" x1="750.2437" x2="791.2437" y1="265.2188" y2="265.2188"/><polygon fill="#181818" points="760.2437,261.2188,750.2437,265.2188,760.2437,269.2188,756.2437,265.2188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8345" x="756.2437" y="247.4766">State: IDLE</text></g><path d="M754,278.2188 L754,349.2188 L1001,349.2188 L1001,288.2188 L991,278.2188 L754,278.2188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M991,278.2188 L991,288.2188 L1001,288.2188 L991,278.2188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.8232" x="760" y="295.7871">Tool lifecycle:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.436" x="760" y="311.0977">1. onActivate() initializes state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226.9287" x="760" y="326.4082">2. Cursor updated via CursorService</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.6758" x="760" y="341.7188">3. Ready for pointer events</text><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="260.9546,371.7715,270.9546,375.7715,260.9546,379.7715,264.9546,375.7715" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="266.9546" y1="375.7715" y2="375.7715"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.9731" x="50.1826" y="371.0293">Click at point A</text></g><g class="message" data-participant-1="Canvas" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,401.082,584.3633,405.082,574.3633,409.082,578.3633,405.082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="580.3633" y1="405.082" y2="405.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.3247" x="279.9546" y="400.3398">handlePointerDown(event)</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="PenTool"><polygon fill="#181818" points="737.2437,430.3926,747.2437,434.3926,737.2437,438.3926,741.2437,434.3926" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="743.2437" y1="434.3926" y2="434.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.8804" x="593.3633" y="429.6504">onPointerDown(event)</text></g><path d="M15,449.3926 L77.1387,449.3926 L77.1387,456.7031 L67.1387,466.7031 L15,466.7031 L15,449.3926" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="605.5215" style="stroke:#000000;stroke-width:1.5;" width="2839.4072" x="15" y="449.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="30" y="462.9609">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="132.1235" x="92.1387" y="462.0273">[First Click (Start Path)]</text><g class="message" data-participant-1="PenTool" data-participant-2="PenTool"><line style="stroke:#181818;stroke-width:1;" x1="749.2437" x2="791.2437" y1="488.0137" y2="488.0137"/><line style="stroke:#181818;stroke-width:1;" x1="791.2437" x2="791.2437" y1="488.0137" y2="501.0137"/><line style="stroke:#181818;stroke-width:1;" x1="750.2437" x2="791.2437" y1="501.0137" y2="501.0137"/><polygon fill="#181818" points="760.2437,497.0137,750.2437,501.0137,760.2437,505.0137,756.2437,501.0137" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.6831" x="756.2437" y="483.2715">State: IDLE &#8594; CREATING_PATH</text></g><g class="message" data-participant-1="PenTool" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,526.3242,1636.7852,530.3242,1626.7852,534.3242,1630.7852,530.3242" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="749.2437" x2="1632.7852" y1="530.3242" y2="530.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.231" x="756.2437" y="525.582">recordEvent(StartGroupEvent)</text></g><path d="M1643,543.3242 L1643,629.3242 L1876,629.3242 L1876,553.3242 L1866,543.3242 L1643,543.3242" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1866,543.3242 L1866,553.3242 L1876,553.3242 L1866,543.3242" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104.9204" x="1649" y="560.8926">Undo Grouping:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.564" x="1649" y="576.2031">StartGroupEvent marks beginning</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.8345" x="1649" y="591.5137">of undoable operation. All events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.6777" x="1649" y="606.8242">until EndGroupEvent are treated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.8774" x="1649" y="622.1348">as single undo unit.</text><g class="message" data-participant-1="Recorder" data-participant-2="Recorder"><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1680.7852" y1="656.1875" y2="656.1875"/><line style="stroke:#181818;stroke-width:1;" x1="1680.7852" x2="1680.7852" y1="656.1875" y2="669.1875"/><line style="stroke:#181818;stroke-width:1;" x1="1639.7852" x2="1680.7852" y1="669.1875" y2="669.1875"/><polygon fill="#181818" points="1649.7852,665.1875,1639.7852,669.1875,1649.7852,673.1875,1645.7852,669.1875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.5371" x="1645.7852" y="651.4453">Assign sequence #N</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Dispatcher"><polygon fill="#181818" points="1826.0923,694.498,1836.0923,698.498,1826.0923,702.498,1830.0923,698.498" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1832.0923" y1="698.498" y2="698.498"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.0933" x="1645.7852" y="693.7559">dispatch(StartGroupEvent)</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,723.8086,2314.2451,727.8086,2304.2451,731.8086,2308.2451,727.8086" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="727.8086" y2="727.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5029" x="1645.7852" y="723.0664">INSERT INTO events</text></g><g class="message" data-participant-1="PenTool" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,753.1191,1636.7852,757.1191,1626.7852,761.1191,1630.7852,757.1191" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="749.2437" x2="1632.7852" y1="757.1191" y2="757.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333.2075" x="756.2437" y="752.377">recordEvent(CreatePathEvent(pathId, startAnchor: A))</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Recorder"><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1680.7852" y1="786.4297" y2="786.4297"/><line style="stroke:#181818;stroke-width:1;" x1="1680.7852" x2="1680.7852" y1="786.4297" y2="799.4297"/><line style="stroke:#181818;stroke-width:1;" x1="1639.7852" x2="1680.7852" y1="799.4297" y2="799.4297"/><polygon fill="#181818" points="1649.7852,795.4297,1639.7852,799.4297,1649.7852,803.4297,1645.7852,799.4297" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.0913" x="1645.7852" y="781.6875">Assign sequence #N+1</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Dispatcher"><polygon fill="#181818" points="1826.0923,824.7402,1836.0923,828.7402,1826.0923,832.7402,1830.0923,828.7402" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1832.0923" y1="828.7402" y2="828.7402"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.0552" x="1645.7852" y="823.998">dispatch(CreatePathEvent)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Doc"><polygon fill="#181818" points="2038.7573,854.0508,2048.7573,858.0508,2038.7573,862.0508,2042.7573,858.0508" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1838.0923" x2="2044.7573" y1="858.0508" y2="858.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.5786" x="1845.0923" y="853.3086">applyEvent(CreatePathEvent)</text></g><g class="message" data-participant-1="Doc" data-participant-2="Doc"><line style="stroke:#181818;stroke-width:1;" x1="2050.7573" x2="2092.7573" y1="887.3613" y2="887.3613"/><line style="stroke:#181818;stroke-width:1;" x1="2092.7573" x2="2092.7573" y1="887.3613" y2="900.3613"/><line style="stroke:#181818;stroke-width:1;" x1="2051.7573" x2="2092.7573" y1="900.3613" y2="900.3613"/><polygon fill="#181818" points="2061.7573,896.3613,2051.7573,900.3613,2061.7573,904.3613,2057.7573,900.3613" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.1362" x="2057.7573" y="882.6191">Create new Path with anchor at A</text></g><g class="message" data-participant-1="Doc" data-participant-2="Dispatcher"><polygon fill="#181818" points="1849.0923,925.6719,1839.0923,929.6719,1849.0923,933.6719,1845.0923,929.6719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1843.0923" x2="2049.7573" y1="929.6719" y2="929.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.6221" x="1855.0923" y="924.9297">New Document state</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,954.9824,2314.2451,958.9824,2304.2451,962.9824,2308.2451,958.9824" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="958.9824" y2="958.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5029" x="1645.7852" y="954.2402">INSERT INTO events</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Canvas"><polygon fill="#181818" points="283.9546,984.293,273.9546,988.293,283.9546,992.293,279.9546,988.293" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="277.9546" x2="1637.7852" y1="988.293" y2="988.293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.3784" x="289.9546" y="983.5508">notifyListeners()</text></g><g class="message" data-participant-1="Canvas" data-participant-2="Renderer"><polygon fill="#181818" points="2768.4775,1013.6035,2778.4775,1017.6035,2768.4775,1021.6035,2772.4775,1017.6035" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="2774.4775" y1="1017.6035" y2="1017.6035"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.2632" x="279.9546" y="1012.8613">paint(Document)</text></g><g class="message" data-participant-1="Renderer" data-participant-2="User"><polygon fill="#181818" points="54.1826,1042.9141,44.1826,1046.9141,54.1826,1050.9141,50.1826,1046.9141" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.1826" x2="2779.4775" y1="1046.9141" y2="1046.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.2959" x="60.1826" y="1042.1719">Shows anchor point at A</text></g><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="260.9546,1079.2246,270.9546,1083.2246,260.9546,1087.2246,264.9546,1083.2246" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="266.9546" y1="1083.2246" y2="1083.2246"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4814" x="50.1826" y="1078.4824">Click at point B</text></g><g class="message" data-participant-1="Canvas" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,1108.5352,584.3633,1112.5352,574.3633,1116.5352,578.3633,1112.5352" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="580.3633" y1="1112.5352" y2="1112.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.3247" x="279.9546" y="1107.793">handlePointerDown(event)</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="PenTool"><polygon fill="#181818" points="737.2437,1137.8457,747.2437,1141.8457,737.2437,1145.8457,741.2437,1141.8457" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="743.2437" y1="1141.8457" y2="1141.8457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.8804" x="593.3633" y="1137.1035">onPointerDown(event)</text></g><g class="message" data-participant-1="PenTool" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,1167.1563,1636.7852,1171.1563,1626.7852,1175.1563,1630.7852,1171.1563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="749.2437" x2="1632.7852" y1="1171.1563" y2="1171.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382.1479" x="756.2437" y="1166.4141">recordEvent(AddAnchorEvent(pathId, position: B, type: LINE))</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Recorder"><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1680.7852" y1="1200.4668" y2="1200.4668"/><line style="stroke:#181818;stroke-width:1;" x1="1680.7852" x2="1680.7852" y1="1200.4668" y2="1213.4668"/><line style="stroke:#181818;stroke-width:1;" x1="1639.7852" x2="1680.7852" y1="1213.4668" y2="1213.4668"/><polygon fill="#181818" points="1649.7852,1209.4668,1639.7852,1213.4668,1649.7852,1217.4668,1645.7852,1213.4668" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.0913" x="1645.7852" y="1195.7246">Assign sequence #N+2</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Dispatcher"><polygon fill="#181818" points="1826.0923,1238.7773,1836.0923,1242.7773,1826.0923,1246.7773,1830.0923,1242.7773" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1832.0923" y1="1242.7773" y2="1242.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.3213" x="1645.7852" y="1238.0352">dispatch(AddAnchorEvent)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Doc"><polygon fill="#181818" points="2038.7573,1268.0879,2048.7573,1272.0879,2038.7573,1276.0879,2042.7573,1272.0879" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1838.0923" x2="2044.7573" y1="1272.0879" y2="1272.0879"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.8447" x="1845.0923" y="1267.3457">applyEvent(AddAnchorEvent)</text></g><g class="message" data-participant-1="Doc" data-participant-2="Doc"><line style="stroke:#181818;stroke-width:1;" x1="2050.7573" x2="2092.7573" y1="1301.3984" y2="1301.3984"/><line style="stroke:#181818;stroke-width:1;" x1="2092.7573" x2="2092.7573" y1="1301.3984" y2="1314.3984"/><line style="stroke:#181818;stroke-width:1;" x1="2051.7573" x2="2092.7573" y1="1314.3984" y2="1314.3984"/><polygon fill="#181818" points="2061.7573,1310.3984,2051.7573,1314.3984,2061.7573,1318.3984,2057.7573,1314.3984" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.9453" x="2057.7573" y="1296.6563">Add anchor B, create line segment A&#8594;B</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,1339.709,2314.2451,1343.709,2304.2451,1347.709,2308.2451,1343.709" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="1343.709" y2="1343.709"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5029" x="1645.7852" y="1338.9668">INSERT INTO events</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Canvas"><polygon fill="#181818" points="283.9546,1369.0195,273.9546,1373.0195,283.9546,1377.0195,279.9546,1373.0195" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="277.9546" x2="1637.7852" y1="1373.0195" y2="1373.0195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.3784" x="289.9546" y="1368.2773">notifyListeners()</text></g><g class="message" data-participant-1="Canvas" data-participant-2="Renderer"><polygon fill="#181818" points="2768.4775,1398.3301,2778.4775,1402.3301,2768.4775,1406.3301,2772.4775,1402.3301" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="2774.4775" y1="1402.3301" y2="1402.3301"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.2632" x="279.9546" y="1397.5879">paint(Document)</text></g><g class="message" data-participant-1="Renderer" data-participant-2="User"><polygon fill="#181818" points="54.1826,1427.6406,44.1826,1431.6406,54.1826,1435.6406,50.1826,1431.6406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.1826" x2="2779.4775" y1="1431.6406" y2="1431.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.5962" x="60.1826" y="1426.8984">Shows line segment A&#8594;B</text></g><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="260.9546,1459.9512,270.9546,1463.9512,260.9546,1467.9512,264.9546,1463.9512" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="266.9546" y1="1463.9512" y2="1463.9512"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.9985" x="50.1826" y="1459.209">Click at point C</text></g><path d="M277,1444.6406 L277,1469.6406 L428,1469.6406 L428,1454.6406 L418,1444.6406 L277,1444.6406" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M418,1444.6406 L418,1454.6406 L428,1454.6406 L418,1444.6406" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.6919" x="283" y="1462.209">Same flow as point B</text><g class="message" data-participant-1="PenTool" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,1492.2617,1636.7852,1496.2617,1626.7852,1500.2617,1630.7852,1496.2617" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="749.2437" x2="1632.7852" y1="1496.2617" y2="1496.2617"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="383.665" x="756.2437" y="1491.5195">recordEvent(AddAnchorEvent(pathId, position: C, type: LINE))</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Dispatcher"><polygon fill="#181818" points="1826.0923,1521.5723,1836.0923,1525.5723,1826.0923,1529.5723,1830.0923,1525.5723" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1832.0923" y1="1525.5723" y2="1525.5723"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.3213" x="1645.7852" y="1520.8301">dispatch(AddAnchorEvent)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Doc"><polygon fill="#181818" points="2038.7573,1550.8828,2048.7573,1554.8828,2038.7573,1558.8828,2042.7573,1554.8828" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1838.0923" x2="2044.7573" y1="1554.8828" y2="1554.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.8447" x="1845.0923" y="1550.1406">applyEvent(AddAnchorEvent)</text></g><g class="message" data-participant-1="Doc" data-participant-2="Doc"><line style="stroke:#181818;stroke-width:1;" x1="2050.7573" x2="2092.7573" y1="1584.1934" y2="1584.1934"/><line style="stroke:#181818;stroke-width:1;" x1="2092.7573" x2="2092.7573" y1="1584.1934" y2="1597.1934"/><line style="stroke:#181818;stroke-width:1;" x1="2051.7573" x2="2092.7573" y1="1597.1934" y2="1597.1934"/><polygon fill="#181818" points="2061.7573,1593.1934,2051.7573,1597.1934,2061.7573,1601.1934,2057.7573,1597.1934" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251.4878" x="2057.7573" y="1579.4512">Add anchor C, create line segment B&#8594;C</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,1622.5039,2314.2451,1626.5039,2304.2451,1630.5039,2308.2451,1626.5039" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="1626.5039" y2="1626.5039"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5029" x="1645.7852" y="1621.7617">INSERT INTO events</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Canvas"><polygon fill="#181818" points="283.9546,1651.8145,273.9546,1655.8145,283.9546,1659.8145,279.9546,1655.8145" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="277.9546" x2="1637.7852" y1="1655.8145" y2="1655.8145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.3784" x="289.9546" y="1651.0723">notifyListeners()</text></g><g class="message" data-participant-1="Renderer" data-participant-2="User"><polygon fill="#181818" points="54.1826,1681.125,44.1826,1685.125,54.1826,1689.125,50.1826,1685.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.1826" x2="2779.4775" y1="1685.125" y2="1685.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.6577" x="60.1826" y="1680.3828">Shows path A&#8594;B&#8594;C</text></g><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="260.9546,1710.4355,270.9546,1714.4355,260.9546,1718.4355,264.9546,1714.4355" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="266.9546" y1="1714.4355" y2="1714.4355"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.1069" x="50.1826" y="1709.6934">Double-click or press Enter</text></g><g class="message" data-participant-1="Canvas" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,1755.0566,584.3633,1759.0566,574.3633,1763.0566,578.3633,1759.0566" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="580.3633" y1="1759.0566" y2="1759.0566"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289.4087" x="279.9546" y="1739.0039">onPointerDown(event) [double-click detected]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.002" x="288.1812" y="1754.3145">OR onKeyPress(Enter)</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="PenTool"><polygon fill="#181818" points="737.2437,1784.3672,747.2437,1788.3672,737.2437,1792.3672,741.2437,1788.3672" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="743.2437" y1="1788.3672" y2="1788.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.8081" x="593.3633" y="1783.625">finishPath()</text></g><g class="message" data-participant-1="PenTool" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,1813.6777,1636.7852,1817.6777,1626.7852,1821.6777,1630.7852,1817.6777" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="749.2437" x2="1632.7852" y1="1817.6777" y2="1817.6777"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316.7671" x="756.2437" y="1812.9355">recordEvent(FinishPathEvent(pathId, closed: false))</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Dispatcher"><polygon fill="#181818" points="1826.0923,1842.9883,1836.0923,1846.9883,1826.0923,1850.9883,1830.0923,1846.9883" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1832.0923" y1="1846.9883" y2="1846.9883"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.4624" x="1645.7852" y="1842.2461">dispatch(FinishPathEvent)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Doc"><polygon fill="#181818" points="2038.7573,1872.2988,2048.7573,1876.2988,2038.7573,1880.2988,2042.7573,1876.2988" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1838.0923" x2="2044.7573" y1="1876.2988" y2="1876.2988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.9858" x="1845.0923" y="1871.5566">applyEvent(FinishPathEvent)</text></g><g class="message" data-participant-1="Doc" data-participant-2="Doc"><line style="stroke:#181818;stroke-width:1;" x1="2050.7573" x2="2092.7573" y1="1905.6094" y2="1905.6094"/><line style="stroke:#181818;stroke-width:1;" x1="2092.7573" x2="2092.7573" y1="1905.6094" y2="1918.6094"/><line style="stroke:#181818;stroke-width:1;" x1="2051.7573" x2="2092.7573" y1="1918.6094" y2="1918.6094"/><polygon fill="#181818" points="2061.7573,1914.6094,2051.7573,1918.6094,2061.7573,1922.6094,2057.7573,1918.6094" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.7998" x="2057.7573" y="1900.8672">Mark path as complete</text></g><g class="message" data-participant-1="PenTool" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,1943.9199,1636.7852,1947.9199,1626.7852,1951.9199,1630.7852,1947.9199" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="749.2437" x2="1632.7852" y1="1947.9199" y2="1947.9199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.3022" x="756.2437" y="1943.1777">recordEvent(EndGroupEvent)</text></g><path d="M1643,1960.9199 L1643,2031.9199 L1882,2031.9199 L1882,1970.9199 L1872,1960.9199 L1643,1960.9199" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1872,1960.9199 L1872,1970.9199 L1882,1970.9199 L1872,1960.9199" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104.9204" x="1649" y="1978.4883">Undo Grouping:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.0293" x="1649" y="1993.7988">EndGroupEvent marks completion.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.0649" x="1649" y="2009.1094">Single Cmd+Z will undo all events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.957" x="1649" y="2024.4199">between Start/End markers.</text><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,2054.4727,2314.2451,2058.4727,2304.2451,2062.4727,2308.2451,2058.4727" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="2058.4727" y2="2058.4727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5029" x="1645.7852" y="2053.7305">INSERT INTO events</text></g><g class="message" data-participant-1="PenTool" data-participant-2="PenTool"><line style="stroke:#181818;stroke-width:1;" x1="749.2437" x2="791.2437" y1="2087.7832" y2="2087.7832"/><line style="stroke:#181818;stroke-width:1;" x1="791.2437" x2="791.2437" y1="2087.7832" y2="2100.7832"/><line style="stroke:#181818;stroke-width:1;" x1="750.2437" x2="791.2437" y1="2100.7832" y2="2100.7832"/><polygon fill="#181818" points="760.2437,2096.7832,750.2437,2100.7832,760.2437,2104.7832,756.2437,2100.7832" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.6831" x="756.2437" y="2083.041">State: CREATING_PATH &#8594; IDLE</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Canvas"><polygon fill="#181818" points="283.9546,2126.0938,273.9546,2130.0938,283.9546,2134.0938,279.9546,2130.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="277.9546" x2="1637.7852" y1="2130.0938" y2="2130.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.3784" x="289.9546" y="2125.3516">notifyListeners()</text></g><g class="message" data-participant-1="Renderer" data-participant-2="User"><polygon fill="#181818" points="54.1826,2155.4043,44.1826,2159.4043,54.1826,2163.4043,50.1826,2159.4043" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.1826" x2="2779.4775" y1="2159.4043" y2="2159.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.0581" x="60.1826" y="2154.6621">Shows completed open path</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2864.4072" x="0" y="2188.0596"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2864.4072" y1="2188.0596" y2="2188.0596"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2864.4072" y1="2191.0596" y2="2191.0596"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="299.4287" x="1282.4893" y="2177.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="281.144" x="1288.4893" y="2193.9727">Direct Selection Tool: Dragging an Anchor</text><g class="message" data-participant-1="User" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,2228.0254,584.3633,2232.0254,574.3633,2236.0254,578.3633,2232.0254" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="580.3633" y1="2232.0254" y2="2232.0254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.7041" x="50.1826" y="2227.2832">Activate Direct Selection Tool</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="PenTool"><polygon fill="#181818" points="737.2437,2257.3359,747.2437,2261.3359,737.2437,2265.3359,741.2437,2261.3359" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="743.2437" y1="2261.3359" y2="2261.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.959" x="593.3633" y="2256.5938">onDeactivate()</text></g><g class="message" data-participant-1="PenTool" data-participant-2="PenTool"><line style="stroke:#181818;stroke-width:1;" x1="749.2437" x2="791.2437" y1="2290.6465" y2="2290.6465"/><line style="stroke:#181818;stroke-width:1;" x1="791.2437" x2="791.2437" y1="2290.6465" y2="2303.6465"/><line style="stroke:#181818;stroke-width:1;" x1="750.2437" x2="791.2437" y1="2303.6465" y2="2303.6465"/><polygon fill="#181818" points="760.2437,2299.6465,750.2437,2303.6465,760.2437,2307.6465,756.2437,2303.6465" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.3789" x="756.2437" y="2285.9043">Cleanup state</text></g><path d="M591,2316.6465 L591,2402.6465 L772,2402.6465 L772,2326.6465 L762,2316.6465 L591,2316.6465" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M762,2316.6465 L762,2326.6465 L772,2326.6465 L762,2316.6465" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.3848" x="597" y="2334.2148">Tool Switch Protocol:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.541" x="597" y="2349.5254">1. Flush pending events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.2529" x="597" y="2364.8359">2. Deactivate current tool</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.8521" x="597" y="2380.1465">3. Activate new tool</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.1934" x="597" y="2395.457">4. Update cursor</text><g class="message" data-participant-1="ToolMgr" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,2425.5098,1636.7852,2429.5098,1626.7852,2433.5098,1630.7852,2429.5098" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="1632.7852" y1="2429.5098" y2="2429.5098"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39.7554" x="593.3633" y="2424.7676">flush()</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,2454.8203,2314.2451,2458.8203,2304.2451,2462.8203,2308.2451,2458.8203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="2458.8203" y2="2458.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.4155" x="1645.7852" y="2454.0781">Persist buffered events</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="DirectSel"><polygon fill="#181818" points="943.9268,2484.1309,953.9268,2488.1309,943.9268,2492.1309,947.9268,2488.1309" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="949.9268" y1="2488.1309" y2="2488.1309"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.769" x="593.3633" y="2483.3887">onActivate()</text></g><g class="message" data-participant-1="DirectSel" data-participant-2="DirectSel"><line style="stroke:#181818;stroke-width:1;" x1="955.9268" x2="997.9268" y1="2517.4414" y2="2517.4414"/><line style="stroke:#181818;stroke-width:1;" x1="997.9268" x2="997.9268" y1="2517.4414" y2="2530.4414"/><line style="stroke:#181818;stroke-width:1;" x1="956.9268" x2="997.9268" y1="2530.4414" y2="2530.4414"/><polygon fill="#181818" points="966.9268,2526.4414,956.9268,2530.4414,966.9268,2534.4414,962.9268,2530.4414" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8345" x="962.9268" y="2512.6992">State: IDLE</text></g><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="260.9546,2555.752,270.9546,2559.752,260.9546,2563.752,264.9546,2559.752" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="266.9546" y1="2559.752" y2="2559.752"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.0122" x="50.1826" y="2555.0098">Mouse down on anchor point</text></g><g class="message" data-participant-1="Canvas" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,2585.0625,584.3633,2589.0625,574.3633,2593.0625,578.3633,2589.0625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="580.3633" y1="2589.0625" y2="2589.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.3247" x="279.9546" y="2584.3203">handlePointerDown(event)</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="DirectSel"><polygon fill="#181818" points="943.9268,2614.373,953.9268,2618.373,943.9268,2622.373,947.9268,2618.373" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="949.9268" y1="2618.373" y2="2618.373"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.8804" x="593.3633" y="2613.6309">onPointerDown(event)</text></g><g class="message" data-participant-1="DirectSel" data-participant-2="Doc"><polygon fill="#181818" points="2038.7573,2643.6836,2048.7573,2647.6836,2038.7573,2651.6836,2042.7573,2647.6836" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="955.9268" x2="2044.7573" y1="2647.6836" y2="2647.6836"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.646" x="962.9268" y="2642.9414">hitTestAnchors(point)</text></g><g class="message" data-participant-1="Doc" data-participant-2="DirectSel"><polygon fill="#181818" points="966.9268,2672.9941,956.9268,2676.9941,966.9268,2680.9941,962.9268,2676.9941" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="960.9268" x2="2049.7573" y1="2676.9941" y2="2676.9941"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.7275" x="972.9268" y="2672.252">Found: pathId=P1, anchorIndex=3</text></g><g class="message" data-participant-1="DirectSel" data-participant-2="DirectSel"><line style="stroke:#181818;stroke-width:1;" x1="955.9268" x2="997.9268" y1="2721.6152" y2="2721.6152"/><line style="stroke:#181818;stroke-width:1;" x1="997.9268" x2="997.9268" y1="2721.6152" y2="2734.6152"/><line style="stroke:#181818;stroke-width:1;" x1="956.9268" x2="997.9268" y1="2734.6152" y2="2734.6152"/><polygon fill="#181818" points="966.9268,2730.6152,956.9268,2734.6152,966.9268,2738.6152,962.9268,2734.6152" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.4609" x="962.9268" y="2701.5625">State: IDLE &#8594; DRAGGING_ANCHOR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272.8032" x="962.9268" y="2716.873">dragContext = {pathId: P1, anchorIndex: 3}</text></g><g class="message" data-participant-1="DirectSel" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,2759.9258,1636.7852,2763.9258,1626.7852,2767.9258,1630.7852,2763.9258" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="955.9268" x2="1632.7852" y1="2763.9258" y2="2763.9258"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.231" x="962.9268" y="2759.1836">recordEvent(StartGroupEvent)</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,2789.2363,2314.2451,2793.2363,2304.2451,2797.2363,2308.2451,2793.2363" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="2793.2363" y2="2793.2363"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5029" x="1645.7852" y="2788.4941">INSERT INTO events</text></g><path d="M960,2806.2363 L960,2846.2363 L1205,2846.2363 L1205,2816.2363 L1195,2806.2363 L960,2806.2363" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1195,2806.2363 L1195,2816.2363 L1205,2816.2363 L1195,2806.2363" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.2471" x="966" y="2823.8047">Drag operation begins.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.853" x="966" y="2839.1152">Subsequent moves will be sampled.</text><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="260.9546,2869.168,270.9546,2873.168,260.9546,2877.168,264.9546,2873.168" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="266.9546" y1="2873.168" y2="2873.168"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.1299" x="50.1826" y="2868.4258">Mouse move (drag at t=0ms)</text></g><g class="message" data-participant-1="Canvas" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,2898.4785,584.3633,2902.4785,574.3633,2906.4785,578.3633,2902.4785" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="580.3633" y1="2902.4785" y2="2902.4785"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.6714" x="279.9546" y="2897.7363">handlePointerMove(event)</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="DirectSel"><polygon fill="#181818" points="943.9268,2927.7891,953.9268,2931.7891,943.9268,2935.7891,947.9268,2931.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="949.9268" y1="2931.7891" y2="2931.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2271" x="593.3633" y="2927.0469">onPointerMove(event)</text></g><g class="message" data-participant-1="DirectSel" data-participant-2="Sampler"><polygon fill="#181818" points="1230.73,2972.4102,1240.73,2976.4102,1230.73,2980.4102,1234.73,2976.4102" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="955.9268" x2="1236.73" y1="2976.4102" y2="2976.4102"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.2153" x="962.9268" y="2956.3574">recordMove(pathId: P1, anchorIndex: 3,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3062" x="962.9268" y="2971.668">newPosition, timestamp: t0)</text></g><path d="M15,2991.4102 L77.1387,2991.4102 L77.1387,2998.7207 L67.1387,3008.7207 L15,3008.7207 L15,2991.4102" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="359.0371" style="stroke:#000000;stroke-width:1.5;" width="2839.4072" x="15" y="2991.4102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="30" y="3004.9785">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="102.7383" x="92.1387" y="3004.0449">[First move event]</text><g class="message" data-participant-1="Sampler" data-participant-2="Sampler"><line style="stroke:#181818;stroke-width:1;" x1="1242.73" x2="1284.73" y1="3030.0313" y2="3030.0313"/><line style="stroke:#181818;stroke-width:1;" x1="1284.73" x2="1284.73" y1="3030.0313" y2="3043.0313"/><line style="stroke:#181818;stroke-width:1;" x1="1243.73" x2="1284.73" y1="3043.0313" y2="3043.0313"/><polygon fill="#181818" points="1253.73,3039.0313,1243.73,3043.0313,1253.73,3047.0313,1249.73,3043.0313" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.2988" x="1249.73" y="3025.2891">Initialize sampling window (t0)</text></g><g class="message" data-participant-1="Sampler" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,3068.3418,1636.7852,3072.3418,1626.7852,3076.3418,1630.7852,3072.3418" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1242.73" x2="1632.7852" y1="3072.3418" y2="3072.3418"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.0376" x="1249.73" y="3067.5996">recordEvent(MoveAnchorEvent(P1, 3, delta))</text></g><path d="M1247,3085.3418 L1247,3156.3418 L1476,3156.3418 L1476,3095.3418 L1466,3085.3418 L1247,3085.3418" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1466,3085.3418 L1466,3095.3418 L1476,3095.3418 L1466,3085.3418" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106.4629" x="1253" y="3102.9102">50ms Sampling:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.4678" x="1253" y="3118.2207">First event emitted immediately.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.9648" x="1253" y="3133.5313">Subsequent events buffered until</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.5488" x="1253" y="3148.8418">50ms threshold reached.</text><g class="message" data-participant-1="Recorder" data-participant-2="Dispatcher"><polygon fill="#181818" points="1826.0923,3178.8945,1836.0923,3182.8945,1826.0923,3186.8945,1830.0923,3182.8945" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1832.0923" y1="3182.8945" y2="3182.8945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.1416" x="1645.7852" y="3178.1523">dispatch(MoveAnchorEvent)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Doc"><polygon fill="#181818" points="2038.7573,3208.2051,2048.7573,3212.2051,2038.7573,3216.2051,2042.7573,3212.2051" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1838.0923" x2="2044.7573" y1="3212.2051" y2="3212.2051"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.665" x="1845.0923" y="3207.4629">applyEvent(MoveAnchorEvent)</text></g><g class="message" data-participant-1="Doc" data-participant-2="Doc"><line style="stroke:#181818;stroke-width:1;" x1="2050.7573" x2="2092.7573" y1="3241.5156" y2="3241.5156"/><line style="stroke:#181818;stroke-width:1;" x1="2092.7573" x2="2092.7573" y1="3241.5156" y2="3254.5156"/><line style="stroke:#181818;stroke-width:1;" x1="2051.7573" x2="2092.7573" y1="3254.5156" y2="3254.5156"/><polygon fill="#181818" points="2061.7573,3250.5156,2051.7573,3254.5156,2061.7573,3258.5156,2057.7573,3254.5156" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226.2876" x="2057.7573" y="3236.7734">Create new Path with moved anchor</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,3279.8262,2314.2451,3283.8262,2304.2451,3287.8262,2308.2451,3283.8262" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="3283.8262" y2="3283.8262"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5029" x="1645.7852" y="3279.084">INSERT INTO events</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Canvas"><polygon fill="#181818" points="283.9546,3309.1367,273.9546,3313.1367,283.9546,3317.1367,279.9546,3313.1367" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="277.9546" x2="1637.7852" y1="3313.1367" y2="3313.1367"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.3784" x="289.9546" y="3308.3945">notifyListeners()</text></g><g class="message" data-participant-1="Renderer" data-participant-2="User"><polygon fill="#181818" points="54.1826,3338.4473,44.1826,3342.4473,54.1826,3346.4473,50.1826,3342.4473" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.1826" x2="2779.4775" y1="3342.4473" y2="3342.4473"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.4189" x="60.1826" y="3337.7051">Anchor position updated</text></g><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="260.9546,3374.7578,270.9546,3378.7578,260.9546,3382.7578,264.9546,3378.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="266.9546" y1="3378.7578" y2="3378.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.3501" x="50.1826" y="3374.0156">Mouse move (drag at t=10ms)</text></g><g class="message" data-participant-1="Canvas" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,3404.0684,584.3633,3408.0684,574.3633,3412.0684,578.3633,3408.0684" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="580.3633" y1="3408.0684" y2="3408.0684"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.6714" x="279.9546" y="3403.3262">handlePointerMove(event)</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="DirectSel"><polygon fill="#181818" points="943.9268,3433.3789,953.9268,3437.3789,943.9268,3441.3789,947.9268,3437.3789" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="949.9268" y1="3437.3789" y2="3437.3789"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2271" x="593.3633" y="3432.6367">onPointerMove(event)</text></g><g class="message" data-participant-1="DirectSel" data-participant-2="Sampler"><polygon fill="#181818" points="1230.73,3462.6895,1240.73,3466.6895,1230.73,3470.6895,1234.73,3466.6895" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="955.9268" x2="1236.73" y1="3466.6895" y2="3466.6895"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.3989" x="962.9268" y="3461.9473">recordMove(..., timestamp: t10)</text></g><g class="message" data-participant-1="Sampler" data-participant-2="Sampler"><line style="stroke:#181818;stroke-width:1;" x1="1242.73" x2="1284.73" y1="3496" y2="3496"/><line style="stroke:#181818;stroke-width:1;" x1="1284.73" x2="1284.73" y1="3496" y2="3509"/><line style="stroke:#181818;stroke-width:1;" x1="1243.73" x2="1284.73" y1="3509" y2="3509"/><polygon fill="#181818" points="1253.73,3505,1243.73,3509,1253.73,3513,1249.73,3509" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.2373" x="1249.73" y="3491.2578">Buffer position (t10 - t0 = 10ms &lt; 50ms)</text></g><path d="M1247,3522 L1247,3562 L1403,3562 L1403,3532 L1393,3522 L1247,3522" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1393,3522 L1393,3532 L1403,3532 L1393,3522" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.4863" x="1253" y="3539.5684">Movement buffered.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.3701" x="1253" y="3554.8789">No event emitted yet.</text><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="260.9546,3584.9316,270.9546,3588.9316,260.9546,3592.9316,264.9546,3588.9316" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="266.9546" y1="3588.9316" y2="3588.9316"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.3501" x="50.1826" y="3584.1895">Mouse move (drag at t=25ms)</text></g><g class="message" data-participant-1="Canvas" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,3614.2422,584.3633,3618.2422,574.3633,3622.2422,578.3633,3618.2422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="580.3633" y1="3618.2422" y2="3618.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.6714" x="279.9546" y="3613.5">handlePointerMove(event)</text></g><g class="message" data-participant-1="DirectSel" data-participant-2="Sampler"><polygon fill="#181818" points="1230.73,3643.5527,1240.73,3647.5527,1230.73,3651.5527,1234.73,3647.5527" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="955.9268" x2="1236.73" y1="3647.5527" y2="3647.5527"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.3989" x="962.9268" y="3642.8105">recordMove(..., timestamp: t25)</text></g><g class="message" data-participant-1="Sampler" data-participant-2="Sampler"><line style="stroke:#181818;stroke-width:1;" x1="1242.73" x2="1284.73" y1="3676.8633" y2="3676.8633"/><line style="stroke:#181818;stroke-width:1;" x1="1284.73" x2="1284.73" y1="3676.8633" y2="3689.8633"/><line style="stroke:#181818;stroke-width:1;" x1="1243.73" x2="1284.73" y1="3689.8633" y2="3689.8633"/><polygon fill="#181818" points="1253.73,3685.8633,1243.73,3689.8633,1253.73,3693.8633,1249.73,3689.8633" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.2373" x="1249.73" y="3672.1211">Buffer position (t25 - t0 = 25ms &lt; 50ms)</text></g><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="260.9546,3715.1738,270.9546,3719.1738,260.9546,3723.1738,264.9546,3719.1738" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="266.9546" y1="3719.1738" y2="3719.1738"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.3501" x="50.1826" y="3714.4316">Mouse move (drag at t=55ms)</text></g><g class="message" data-participant-1="Canvas" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,3744.4844,584.3633,3748.4844,574.3633,3752.4844,578.3633,3748.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="580.3633" y1="3748.4844" y2="3748.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.6714" x="279.9546" y="3743.7422">handlePointerMove(event)</text></g><g class="message" data-participant-1="DirectSel" data-participant-2="Sampler"><polygon fill="#181818" points="1230.73,3773.7949,1240.73,3777.7949,1230.73,3781.7949,1234.73,3777.7949" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="955.9268" x2="1236.73" y1="3777.7949" y2="3777.7949"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.3989" x="962.9268" y="3773.0527">recordMove(..., timestamp: t55)</text></g><path d="M15,3792.7949 L77.1387,3792.7949 L77.1387,3800.1055 L67.1387,3810.1055 L15,3810.1055 L15,3792.7949" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="359.0371" style="stroke:#000000;stroke-width:1.5;" width="2839.4072" x="15" y="3792.7949"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="30" y="3806.3633">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="153.9785" x="92.1387" y="3805.4297">[50ms threshold exceeded]</text><g class="message" data-participant-1="Sampler" data-participant-2="Sampler"><line style="stroke:#181818;stroke-width:1;" x1="1242.73" x2="1284.73" y1="3831.416" y2="3831.416"/><line style="stroke:#181818;stroke-width:1;" x1="1284.73" x2="1284.73" y1="3831.416" y2="3844.416"/><line style="stroke:#181818;stroke-width:1;" x1="1243.73" x2="1284.73" y1="3844.416" y2="3844.416"/><polygon fill="#181818" points="1253.73,3840.416,1243.73,3844.416,1253.73,3848.416,1249.73,3844.416" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311.2891" x="1249.73" y="3826.6738">Emit buffered position (t55 - t0 = 55ms &#8805; 50ms)</text></g><g class="message" data-participant-1="Sampler" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,3869.7266,1636.7852,3873.7266,1626.7852,3877.7266,1630.7852,3873.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1242.73" x2="1632.7852" y1="3873.7266" y2="3873.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="372.0552" x="1249.73" y="3868.9844">recordEvent(MoveAnchorEvent(P1, 3, delta_from_buffered))</text></g><path d="M1247,3886.7266 L1247,3957.7266 L1481,3957.7266 L1481,3896.7266 L1471,3886.7266 L1247,3886.7266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1471,3886.7266 L1471,3896.7266 L1481,3896.7266 L1471,3886.7266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.3252" x="1253" y="3904.2949">Sampling Result:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.5591" x="1253" y="3919.6055">4 raw mouse moves &#8594; 1 event</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.2275" x="1253" y="3934.916">Reduces storage by ~75%</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213.8843" x="1253" y="3950.2266">Maintains smooth visual feedback</text><g class="message" data-participant-1="Recorder" data-participant-2="Dispatcher"><polygon fill="#181818" points="1826.0923,3980.2793,1836.0923,3984.2793,1826.0923,3988.2793,1830.0923,3984.2793" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1832.0923" y1="3984.2793" y2="3984.2793"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.1416" x="1645.7852" y="3979.5371">dispatch(MoveAnchorEvent)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Doc"><polygon fill="#181818" points="2038.7573,4009.5898,2048.7573,4013.5898,2038.7573,4017.5898,2042.7573,4013.5898" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1838.0923" x2="2044.7573" y1="4013.5898" y2="4013.5898"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.665" x="1845.0923" y="4008.8477">applyEvent(MoveAnchorEvent)</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,4038.9004,2314.2451,4042.9004,2304.2451,4046.9004,2308.2451,4042.9004" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="4042.9004" y2="4042.9004"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5029" x="1645.7852" y="4038.1582">INSERT INTO events</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Canvas"><polygon fill="#181818" points="283.9546,4068.2109,273.9546,4072.2109,283.9546,4076.2109,279.9546,4072.2109" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="277.9546" x2="1637.7852" y1="4072.2109" y2="4072.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.3784" x="289.9546" y="4067.4688">notifyListeners()</text></g><g class="message" data-participant-1="Renderer" data-participant-2="User"><polygon fill="#181818" points="54.1826,4097.5215,44.1826,4101.5215,54.1826,4105.5215,50.1826,4101.5215" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.1826" x2="2779.4775" y1="4101.5215" y2="4101.5215"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9468" x="60.1826" y="4096.7793">Smooth anchor movement</text></g><g class="message" data-participant-1="Sampler" data-participant-2="Sampler"><line style="stroke:#181818;stroke-width:1;" x1="1242.73" x2="1284.73" y1="4130.832" y2="4130.832"/><line style="stroke:#181818;stroke-width:1;" x1="1284.73" x2="1284.73" y1="4130.832" y2="4143.832"/><line style="stroke:#181818;stroke-width:1;" x1="1243.73" x2="1284.73" y1="4143.832" y2="4143.832"/><polygon fill="#181818" points="1253.73,4139.832,1243.73,4143.832,1253.73,4147.832,1249.73,4143.832" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.1333" x="1249.73" y="4126.0898">Reset sampling window (t55)</text></g><path d="M5,4163.832 L5,4218.832 L2819,4218.832 L2819,4173.832 L2809,4163.832 L5,4163.832" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2809,4163.832 L2809,4173.832 L2819,4173.832 L2809,4163.832" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.6553" x="1230.6199" y="4181.4004">Drag continues...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="343.6875" x="1230.6199" y="4196.7109">More pointer moves occur, sampled at 50ms intervals.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354.1675" x="1230.6199" y="4212.0215">A 2-second drag generates ~40 events instead of ~200.</text><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="260.9546,4242.0742,270.9546,4246.0742,260.9546,4250.0742,264.9546,4246.0742" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="266.9546" y1="4246.0742" y2="4246.0742"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.772" x="50.1826" y="4241.332">Mouse up (release at t=2000ms)</text></g><g class="message" data-participant-1="Canvas" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,4271.3848,584.3633,4275.3848,574.3633,4279.3848,578.3633,4275.3848" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="580.3633" y1="4275.3848" y2="4275.3848"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.707" x="279.9546" y="4270.6426">handlePointerUp(event)</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="DirectSel"><polygon fill="#181818" points="943.9268,4300.6953,953.9268,4304.6953,943.9268,4308.6953,947.9268,4304.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="949.9268" y1="4304.6953" y2="4304.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.2627" x="593.3633" y="4299.9531">onPointerUp(event)</text></g><g class="message" data-participant-1="DirectSel" data-participant-2="Sampler"><polygon fill="#181818" points="1230.73,4330.0059,1240.73,4334.0059,1230.73,4338.0059,1234.73,4334.0059" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="955.9268" x2="1236.73" y1="4334.0059" y2="4334.0059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39.7554" x="962.9268" y="4329.2637">flush()</text></g><path d="M1177.8716,4349.0059 L1240.0103,4349.0059 L1240.0103,4356.3164 L1230.0103,4366.3164 L1177.8716,4366.3164 L1177.8716,4349.0059" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="200.4844" style="stroke:#000000;stroke-width:1.5;" width="1193.3198" x="1177.8716" y="4349.0059"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="1192.8716" y="4362.5742">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="156.7339" x="1255.0103" y="4361.6406">[Buffered movement exists]</text><g class="message" data-participant-1="Sampler" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,4383.627,1636.7852,4387.627,1626.7852,4391.627,1630.7852,4387.627" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1242.73" x2="1632.7852" y1="4387.627" y2="4387.627"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286.6157" x="1249.73" y="4382.8848">recordEvent(MoveAnchorEvent(final position))</text></g><path d="M1247,4400.627 L1247,4455.627 L1480,4455.627 L1480,4410.627 L1470,4400.627 L1247,4400.627" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1470,4400.627 L1470,4410.627 L1480,4410.627 L1470,4400.627" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115.7813" x="1253" y="4418.1953">Flush on Release:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.6465" x="1253" y="4433.5059">Ensures final position is persisted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.0562" x="1253" y="4448.8164">even if &lt; 50ms since last sample.</text><g class="message" data-participant-1="Recorder" data-participant-2="Dispatcher"><polygon fill="#181818" points="1826.0923,4478.8691,1836.0923,4482.8691,1826.0923,4486.8691,1830.0923,4482.8691" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1832.0923" y1="4482.8691" y2="4482.8691"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.1416" x="1645.7852" y="4478.127">dispatch(MoveAnchorEvent)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Doc"><polygon fill="#181818" points="2038.7573,4508.1797,2048.7573,4512.1797,2038.7573,4516.1797,2042.7573,4512.1797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1838.0923" x2="2044.7573" y1="4512.1797" y2="4512.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.665" x="1845.0923" y="4507.4375">applyEvent(MoveAnchorEvent)</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,4537.4902,2314.2451,4541.4902,2304.2451,4545.4902,2308.2451,4541.4902" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="4541.4902" y2="4541.4902"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5029" x="1645.7852" y="4536.748">INSERT INTO events</text></g><g class="message" data-participant-1="DirectSel" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,4573.8008,1636.7852,4577.8008,1626.7852,4581.8008,1630.7852,4577.8008" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="955.9268" x2="1632.7852" y1="4577.8008" y2="4577.8008"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.3022" x="962.9268" y="4573.0586">recordEvent(EndGroupEvent)</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,4603.1113,2314.2451,4607.1113,2304.2451,4611.1113,2308.2451,4607.1113" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="4607.1113" y2="4607.1113"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5029" x="1645.7852" y="4602.3691">INSERT INTO events</text></g><g class="message" data-participant-1="DirectSel" data-participant-2="DirectSel"><line style="stroke:#181818;stroke-width:1;" x1="955.9268" x2="997.9268" y1="4636.4219" y2="4636.4219"/><line style="stroke:#181818;stroke-width:1;" x1="997.9268" x2="997.9268" y1="4636.4219" y2="4649.4219"/><line style="stroke:#181818;stroke-width:1;" x1="956.9268" x2="997.9268" y1="4649.4219" y2="4649.4219"/><polygon fill="#181818" points="966.9268,4645.4219,956.9268,4649.4219,966.9268,4653.4219,962.9268,4649.4219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.4609" x="962.9268" y="4631.6797">State: DRAGGING_ANCHOR &#8594; IDLE</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,4674.7324,1636.7852,4678.7324,1626.7852,4682.7324,1630.7852,4678.7324" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="1632.7852" y1="4678.7324" y2="4678.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39.7554" x="593.3633" y="4673.9902">flush()</text></g><path d="M591,4691.7324 L591,4762.7324 L815,4762.7324 L815,4701.7324 L805,4691.7324 L591,4691.7324" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M805,4691.7324 L805,4701.7324 L815,4701.7324 L805,4691.7324" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.0088" x="597" y="4709.3008">Pointer Up Protocol:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.6992" x="597" y="4724.6113">ToolManager calls flush() after</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.1147" x="597" y="4739.9219">pointer up to ensure all events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.9756" x="597" y="4755.2324">persisted before next operation.</text><g class="message" data-participant-1="Recorder" data-participant-2="Canvas"><polygon fill="#181818" points="283.9546,4785.2852,273.9546,4789.2852,283.9546,4793.2852,279.9546,4789.2852" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="277.9546" x2="1637.7852" y1="4789.2852" y2="4789.2852"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.3784" x="289.9546" y="4784.543">notifyListeners()</text></g><g class="message" data-participant-1="Renderer" data-participant-2="User"><polygon fill="#181818" points="54.1826,4814.5957,44.1826,4818.5957,54.1826,4822.5957,50.1826,4818.5957" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.1826" x2="2779.4775" y1="4818.5957" y2="4818.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.375" x="60.1826" y="4813.8535">Final anchor position rendered</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2864.4072" x="0" y="4847.251"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2864.4072" y1="4847.251" y2="4847.251"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2864.4072" y1="4850.251" y2="4850.251"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="239.7354" x="1312.3359" y="4836.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="221.4507" x="1318.3359" y="4853.1641">Undo: Reverting the Anchor Drag</text><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="260.9546,4887.2168,270.9546,4891.2168,260.9546,4895.2168,264.9546,4891.2168" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.1826" x2="266.9546" y1="4891.2168" y2="4891.2168"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.4316" x="50.1826" y="4886.4746">Press Cmd+Z (Undo)</text></g><g class="message" data-participant-1="Canvas" data-participant-2="ToolMgr"><polygon fill="#181818" points="574.3633,4916.5273,584.3633,4920.5273,574.3633,4924.5273,578.3633,4920.5273" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="272.9546" x2="580.3633" y1="4920.5273" y2="4920.5273"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.7583" x="279.9546" y="4915.7852">undo()</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="Recorder"><polygon fill="#181818" points="1626.7852,4945.8379,1636.7852,4949.8379,1626.7852,4953.8379,1630.7852,4949.8379" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.3633" x2="1632.7852" y1="4949.8379" y2="4949.8379"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.2939" x="593.3633" y="4945.0957">pauseRecording()</text></g><path d="M1643,4962.8379 L1643,5033.8379 L1870,5033.8379 L1870,4972.8379 L1860,4962.8379 L1643,4962.8379" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1860,4962.8379 L1860,4972.8379 L1870,4972.8379 L1860,4962.8379" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132.0249" x="1649" y="4980.4063">Pause During Undo:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.5518" x="1649" y="4995.7168">Prevents circular event creation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.4702" x="1649" y="5011.0273">when replaying events to restore</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.9106" x="1649" y="5026.3379">previous state.</text><g class="message" data-participant-1="Recorder" data-participant-2="Recorder"><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1680.7852" y1="5075.7012" y2="5075.7012"/><line style="stroke:#181818;stroke-width:1;" x1="1680.7852" x2="1680.7852" y1="5075.7012" y2="5088.7012"/><line style="stroke:#181818;stroke-width:1;" x1="1639.7852" x2="1680.7852" y1="5088.7012" y2="5088.7012"/><polygon fill="#181818" points="1649.7852,5084.7012,1639.7852,5088.7012,1649.7852,5092.7012,1645.7852,5088.7012" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.4087" x="1645.7852" y="5055.6484">currentSequence = N</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.3071" x="1645.7852" y="5070.959">Find previous EndGroupEvent</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,5190.5645,2314.2451,5194.5645,2304.2451,5198.5645,2308.2451,5194.5645" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="5194.5645" y2="5194.5645"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.3286" x="1645.7852" y="5113.2695">SELECT event_sequence</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.3706" x="1645.7852" y="5128.5801">FROM events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235.5298" x="1645.7852" y="5143.8906">WHERE event_type = 'EndGroupEvent'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.564" x="1645.7852" y="5159.2012">AND event_sequence &lt; N</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.9946" x="1645.7852" y="5174.5117">ORDER BY event_sequence DESC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46.1729" x="1645.7852" y="5189.8223">LIMIT 1</text></g><g class="message" data-participant-1="EventStore" data-participant-2="Recorder"><polygon fill="#181818" points="1649.7852,5219.875,1639.7852,5223.875,1649.7852,5227.875,1645.7852,5223.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1643.7852" x2="2315.2451" y1="5223.875" y2="5223.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.0298" x="1655.7852" y="5219.1328">targetSequence = M (before drag group)</text></g><g class="message" data-participant-1="Recorder" data-participant-2="SnapMgr"><polygon fill="#181818" points="2577.3018,5249.1855,2587.3018,5253.1855,2577.3018,5257.1855,2581.3018,5253.1855" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2583.3018" y1="5253.1855" y2="5253.1855"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243.3882" x="1645.7852" y="5248.4434">getSnapshotBefore(targetSequence: M)</text></g><g class="message" data-participant-1="SnapMgr" data-participant-2="EventStore"><polygon fill="#181818" points="2327.2451,5339.7383,2317.2451,5343.7383,2327.2451,5347.7383,2323.2451,5343.7383" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2321.2451" x2="2588.3018" y1="5343.7383" y2="5343.7383"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.0566" x="2333.2451" y="5277.7539">SELECT snapshot_data, event_sequence</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.8252" x="2333.2451" y="5293.0645">FROM snapshots</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.167" x="2333.2451" y="5308.375">WHERE event_sequence &lt;= M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.9946" x="2333.2451" y="5323.6855">ORDER BY event_sequence DESC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46.1729" x="2333.2451" y="5338.9961">LIMIT 1</text></g><g class="message" data-participant-1="EventStore" data-participant-2="SnapMgr"><polygon fill="#181818" points="2577.3018,5369.0488,2587.3018,5373.0488,2577.3018,5377.0488,2581.3018,5373.0488" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2316.2451" x2="2583.3018" y1="5373.0488" y2="5373.0488"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.3853" x="2323.2451" y="5368.3066">Snapshot at sequence K, BLOB</text></g><g class="message" data-participant-1="SnapMgr" data-participant-2="SnapMgr"><line style="stroke:#181818;stroke-width:1;" x1="2589.3018" x2="2631.3018" y1="5402.3594" y2="5402.3594"/><line style="stroke:#181818;stroke-width:1;" x1="2631.3018" x2="2631.3018" y1="5402.3594" y2="5415.3594"/><line style="stroke:#181818;stroke-width:1;" x1="2590.3018" x2="2631.3018" y1="5415.3594" y2="5415.3594"/><polygon fill="#181818" points="2600.3018,5411.3594,2590.3018,5415.3594,2600.3018,5419.3594,2596.3018,5415.3594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.1758" x="2596.3018" y="5397.6172">Decompress and deserialize</text></g><g class="message" data-participant-1="SnapMgr" data-participant-2="Recorder"><polygon fill="#181818" points="1649.7852,5440.6699,1639.7852,5444.6699,1649.7852,5448.6699,1645.7852,5444.6699" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1643.7852" x2="2588.3018" y1="5444.6699" y2="5444.6699"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.5981" x="1655.7852" y="5439.9277">Base Document at sequence K</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2304.2451,5515.9121,2314.2451,5519.9121,2304.2451,5523.9121,2308.2451,5519.9121" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="2310.2451" y1="5519.9121" y2="5519.9121"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.1021" x="1645.7852" y="5469.2383">SELECT * FROM events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.1226" x="1645.7852" y="5484.5488">WHERE event_sequence &gt; K</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.4912" x="1645.7852" y="5499.8594">AND event_sequence &lt;= M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.1807" x="1645.7852" y="5515.1699">ORDER BY event_sequence ASC</text></g><g class="message" data-participant-1="EventStore" data-participant-2="Recorder"><polygon fill="#181818" points="1649.7852,5545.2227,1639.7852,5549.2227,1649.7852,5553.2227,1645.7852,5549.2227" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1643.7852" x2="2315.2451" y1="5549.2227" y2="5549.2227"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="1655.7852" y="5544.4805">Events K+1 to M</text></g><path d="M1571.0454,5564.2227 L1645.4922,5564.2227 L1645.4922,5571.5332 L1635.4922,5581.5332 L1571.0454,5581.5332 L1571.0454,5564.2227" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="118.2422" style="stroke:#000000;stroke-width:1.5;" width="581.0093" x="1571.0454" y="5564.2227"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="1586.0454" y="5577.791">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="155.1494" x="1660.4922" y="5576.8574">[For each event (K+1 to M)]</text><g class="message" data-participant-1="Recorder" data-participant-2="Dispatcher"><polygon fill="#181818" points="1826.0923,5598.8438,1836.0923,5602.8438,1826.0923,5606.8438,1830.0923,5602.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1832.0923" y1="5602.8438" y2="5602.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.1162" x="1645.7852" y="5598.1016">dispatch(event)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Doc"><polygon fill="#181818" points="2038.7573,5628.1543,2048.7573,5632.1543,2038.7573,5636.1543,2042.7573,5632.1543" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1838.0923" x2="2044.7573" y1="5632.1543" y2="5632.1543"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.6396" x="1845.0923" y="5627.4121">applyEvent(event)</text></g><g class="message" data-participant-1="Doc" data-participant-2="Doc"><line style="stroke:#181818;stroke-width:1;" x1="2050.7573" x2="2092.7573" y1="5661.4648" y2="5661.4648"/><line style="stroke:#181818;stroke-width:1;" x1="2092.7573" x2="2092.7573" y1="5661.4648" y2="5674.4648"/><line style="stroke:#181818;stroke-width:1;" x1="2051.7573" x2="2092.7573" y1="5674.4648" y2="5674.4648"/><polygon fill="#181818" points="2061.7573,5670.4648,2051.7573,5674.4648,2061.7573,5678.4648,2057.7573,5674.4648" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2974" x="2057.7573" y="5656.7227">Rebuild state</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Recorder"><line style="stroke:#181818;stroke-width:1;" x1="1638.7852" x2="1680.7852" y1="5710.7754" y2="5710.7754"/><line style="stroke:#181818;stroke-width:1;" x1="1680.7852" x2="1680.7852" y1="5710.7754" y2="5723.7754"/><line style="stroke:#181818;stroke-width:1;" x1="1639.7852" x2="1680.7852" y1="5723.7754" y2="5723.7754"/><polygon fill="#181818" points="1649.7852,5719.7754,1639.7852,5723.7754,1649.7852,5727.7754,1645.7852,5723.7754" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.002" x="1645.7852" y="5706.0332">currentSequence = M</text></g><g class="message" data-participant-1="Recorder" data-participant-2="ToolMgr"><polygon fill="#181818" points="597.3633,5749.0859,587.3633,5753.0859,597.3633,5757.0859,593.3633,5753.0859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="591.3633" x2="1637.7852" y1="5753.0859" y2="5753.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.6313" x="603.3633" y="5748.3438">resumeRecording()</text></g><path d="M1643,5766.0859 L1643,5821.0859 L1855,5821.0859 L1855,5776.0859 L1845,5766.0859 L1643,5766.0859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1845,5766.0859 L1845,5776.0859 L1855,5776.0859 L1845,5766.0859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.6729" x="1649" y="5783.6543">Resume recording after state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.1216" x="1649" y="5798.9648">restored. New events will start</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.644" x="1649" y="5814.2754">from sequence M+1.</text><g class="message" data-participant-1="Recorder" data-participant-2="Canvas"><polygon fill="#181818" points="283.9546,5844.3281,273.9546,5848.3281,283.9546,5852.3281,279.9546,5848.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="277.9546" x2="1637.7852" y1="5848.3281" y2="5848.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.3784" x="289.9546" y="5843.5859">notifyListeners()</text></g><g class="message" data-participant-1="Renderer" data-participant-2="User"><polygon fill="#181818" points="54.1826,5873.6387,44.1826,5877.6387,54.1826,5881.6387,50.1826,5877.6387" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.1826" x2="2779.4775" y1="5877.6387" y2="5877.6387"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284.4639" x="60.1826" y="5872.8965">Document state before drag (undo complete)</text></g><path d="M5,5890.6387 L5,5961.6387 L2819,5961.6387 L2819,5900.6387 L2809,5890.6387 L5,5890.6387" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2809,5890.6387 L2809,5900.6387 L2819,5900.6387 L2809,5890.6387" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="163.4014" x="1221.8093" y="5908.207">Undo Grouping Benefits:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371.7886" x="1221.8093" y="5923.5176">- Single Cmd+Z undoes entire drag operation (~40 events)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243.0835" x="1221.8093" y="5938.8281">- Users perceive drag as atomic action</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301.5771" x="1221.8093" y="5954.1387">- Matches expectations from other design tools</text><path d="M2463,5971.8809 L2463,6103.8809 L2713,6103.8809 L2713,5981.8809 L2703,5971.8809 L2463,5971.8809" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2703,5971.8809 L2703,5981.8809 L2713,5981.8809 L2703,5971.8809" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="126.312" x="2469" y="5989.4492">Snapshot Triggers:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.9751" x="2469" y="6004.7598">- Created every 1000 events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.7026" x="2469" y="6020.0703">- Enables fast undo/redo (&lt; 100ms)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.4102" x="2469" y="6035.3809">- Max 1000 events to replay</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="2469" y="6050.6914">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.4219" x="2469" y="6066.002">Latency Budget:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.6729" x="2469" y="6081.3125">- Snapshot creation: &lt; 25ms</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.229" x="2469" y="6096.623">- Undo/Redo navigation: &lt; 100ms</text><path d="M1107,6114.3652 L1107,6261.3652 L1377,6261.3652 L1377,6124.3652 L1367,6114.3652 L1107,6114.3652" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1367,6114.3652 L1367,6124.3652 L1377,6124.3652 L1367,6114.3652" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162.0747" x="1113" y="6131.9336">Sampling Configuration:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.7563" x="1113" y="6147.2441">- Threshold: 50ms (20 samples/sec)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.5029" x="1113" y="6162.5547">- Buffering: Latest position kept</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.5073" x="1113" y="6177.8652">- Flush triggers: pointer up, tool switch</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1113" y="6193.1758">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137.2808" x="1113" y="6208.4863">Performance Impact:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.9707" x="1113" y="6223.7969">- Storage: 5-10x reduction</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.6855" x="1113" y="6239.1074">- Replay: Smooth at 20 fps</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.1055" x="1113" y="6254.418">- Imperceptible to users</text><path d="M1484,6272.1602 L1484,6419.1602 L1792,6419.1602 L1792,6282.1602 L1782,6272.1602 L1484,6272.1602" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1782,6272.1602 L1782,6282.1602 L1792,6282.1602 L1782,6272.1602" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="163.6616" x="1490" y="6289.7285">Undo Grouping Markers:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268.0234" x="1490" y="6305.0391">- StartGroupEvent: Begin atomic operation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.8472" x="1490" y="6320.3496">- EndGroupEvent: Complete atomic operation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.3833" x="1490" y="6335.6602">- Navigator finds group boundaries</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1490" y="6350.9707">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71.2588" x="1490" y="6366.2813">Use Cases:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.5933" x="1490" y="6381.5918">- Drag operations (all moves = 1 undo)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.6699" x="1490" y="6396.9023">- Multi-step tool actions</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.7319" x="1490" y="6412.2129">- Batch modifications</text><!--SRC=[pLfjRzl84VwkNx6uGozIOYkI4wC7uNo0B2av8PPiI4eFrxemQ78biQ58bKlwfKNlOu5-xN_e7xjVqcTcT_aYKvQSYwyraDWaPsTdv-NPcTbD_2IGOXP5WHY6YOmTD_6ZK4pbNrCPkb8SYWiPwkzEwE5z83K5l_enYZ_DW-XMrMelnCaN_06xsT9NmlETHUoiX1y4gKfY9v5A94if4fhTBmYyTX8yX0elnOz-B6TfAEC3i57BwDOF5mA_n3hY8KBUo31HWYG7jpXA5ykSwnppoLiiJCoZM5n7oH9Sw6kcY3ecMmetbWvDtIWhvdKVixj9GLF4LObwTFqNl02lbHFwwpJGWvjGknka7jR5KWdbhDO113uGQUX5OW7frln8iwW46Y06paAkGDsilG33Fbvsn57hwFYmtJviVOjNVv2n0lkEQ3TRU9n8J2UzZl0YLxrMQud_IQohWWfLS-KT50bOdgl0dqlttWqaFkUSnCntFyb4TSIirVxsSDOwUlkbFQ06iM20Zqh6jRKJ9xxhhnqewAkU4zuu2bRs5ZBvIk1F_QPCnPOQiQPY9g8NeqLSgrr7T_gp-afyVUOlbadltWbhGfJ6MslpM3pGtviqcwQ-3BCH-XE-r2JiXYdDl0CsyaIwKUoHMtuZfiRWLfZJ89MR4-bHJ6bMO_wk9jJi3QLzg1Ja8evSgLHX-lUnb64rsxwluFdkqZ3E7n_e9NBJ5KjC_dePreUhLPeuru5iw96Hko7D1VchIXXolX4VuVbMdfzaW33TeX0uY6IE_CoFcvJJq5a30vAIBz1ByeLCY2e7c-2hZ3CjweTd0BffRp3kJeRdejqH5uEnc9sVdm5tUumlS157N13UtFhuRmeC9At0vnQaOVN5e-xa90EwpWCPY802KXn-R-D9T4GNpdz3m6G7rkmta9dG0LaKMi9wesPVboZONJfYs3yRr6fX18unBpQQ5oAGQJDKwk1DkrdYZIt0JtmdyFy6K6N41CrHK_JIM05GqhN727RZE-RLLCOtlajKRvemjEFTC_INTmls5P8fru3n4wWf01eA9z53HBTclfIqj0I01_92C-r7js6T6JUsAQk2ikO4YNZdnoenKzQXiJXXspGW_YwbYb_- -M_Hcmowi-7u_TL5T_P3UP252eoA-KyEApt9Uzg81aOE8ShMoJ16uEVbIufVyTxiN9sNB_dr1XViOl4d9QxbmWz3a34DMD6kHqWXeZLs9aBLfkW6WRK2KQLXuWTY47e5RawCxPkyLNfC0-qJge4FRwCfNAA93xaHHRxQyigxWCD5A9JDWBuURz3ck0TgppmyL59vK0vG63GSJmUJ6NxDpkswzZ84XwCaQ-jdoaE6sBGLpTqDtMKKG_v6uocBUzNUQtaRKzCK1K8Q5hcWTzRhuBvIM1u1cenKVnUXl2tWcyEBe53gMlfDaSOOa6qmDhoVgEeYUHR5y0j_Vd_6sn2sepf9d0UotG10k7OGcNKhWzQs-KZICZmWxf1nAhiW3GoyB93kXf3JPuEGtLxMzJpjIsKdMqVAJpYdF3qGoVqQc78s70_WRVlxsb5jjwULfs_KThZP0_AYZ-6ZjG24ThN78TcIa8htJz4599xMdk8-U_hENfwptMygXDpfDBt2djcX357g4WUqrgk-XFbxZvZ_DpLfhzgafz1MxpbCkjrQN12obNZkXvRgHodsj4EN3KPu42FhnXQ6wAoCzAhO5N_oYbmycQ32aDwVBqCXpYSOya7UNn3VElFTWWfpP4TgIOXRtmiDtcNqPNzmWqXHHJbt0YNtye8DJZlTu25zqGz6I1-qtg4xDw9gYBRrtGigvGsDsjP4fZADAISTEeKnarEc0egfpZfwA-_L7x6d8NFX1CGffZ3NChb5bQLJejVWoPpWPCr2blaK1tuiyIlbUvm1SdxzgttUwjoZJ8qRCCldB8wE44J3oQ0t4zF16NuDpxDAgHyxYmLNAQ7Gm24uUaHTrqocm6uyHwtqeDkZ2wSAaNRKJfMCjctiVUdiAALwWNJ2T6qIf0qljwqGSdAcdq9HxfAw0KdaGdxsTPHLxu9KBGNCoxsAp7zHJEKI23UDOug6HDTdgA6oHL5oPrw_ROgFN7aHFOgkWgSN5bc8sJdDNMziZmFJCn3NwNmE5_MiV0LsMHTci_pCFsnGbKhG1p0-Yb8bXGTC1hjIRlVP-LfPnAgChImhWz_IJsPIcPHVrLa2WuyRBDz5W9-EqAXzSj4-C58F4TPt9szgUsc2KQC_wRv_JpZI7VT-E9zSXXvyl1T1tBj4d8Y_wobWbl8S7V7c7nkpx5jcFYcfBtjutduJ78jvDQahJiLGdLxhv1H87jr8fU7wMkeUhFIQZzNysXLedAYJ9YWDIqvQAzNOxGeZZDhN5OgqPJMQ5c2cHQRSReM3on3XU67IEEHm_Wek11uTaRHAlGLU54z9IZApb2OSPXsMh5yDvM6VknLrObOQjiNS96unqII9tnmWhGaIfr7HOyWxdWHRnz1qXkosnQ35rtrqkV8JsfpyrKfwFbmvk6_gFaHkTNCEa048DnQOYDadIsHJooZm8BU3DCLxh8DGdVDiB7AFihbgnCwocIncq-8dLiDFA8QhSe6knK3jLhQxjgNAhGwQzlD6pUwWQJQRvNXeKq1KUluf-qg-tZfeaO8aBK0WhKDynxwpcLVcpaiJSfbYlOwSQXnjUEszJ3u3VOwEdwp8pr3EqN5ZNzqS7LlTa6YPRlPTp_5lifxZOuD-6q4lxrmfFUudLYvt05lbs55OzN6sQbg0-ELV_p7h_hMmU3MFezMLdN8tI5fyn5mg3H8Basz5xDn2sLRbYlVtTWRv5EbUwdBtF88nfBY-5p___lXt_6r4FGpymzTL505yRdoLEe6OGrdNZllfVuEHlo7aJVMoJVQtCl5Ss-OcqBrCAhP9SZj6IROWkEYppeFyg8bCoCcBYopB3rEfuBjimn6jpPvFQ1D6BlBg0vkwKFomEpF93MfqWfckE3fKM3hCmq6se8NocVhFRrjsDuHb4-buv4q_7xLQUy0GoenwZBh5mTyQXrgj_I3zutfVGCyfjuMuhHSub4zjM5hp89fXMFLP8JZtG_Yt3V3TOQUh9a31H2l5njqWL2d0HPJv2L-XmjB7d_hiWXOg_Bc1Iph7SAK876MyI3R__qEC7NkVf7-Z6_Eab7zNwR9HiUIzZnqLv_PYsJWZAjcDMfc9z06pS9qWK9QPSEQ9FY0tGn4i2NPxTeLoLoXp0fGWSrfrI9LLVWosfJVqnERDEtO-PoDjYpMbzvmTd3STyN7SFnVd5uD9b_itTTr66pit_a9VXtcE5WsryGY6WR1ybartUKpQokXQRCnaokH6gkdYrOb3DPfHRuymfzgXrWxWCRlhKN-qsNX1jAAVnYGYYyoE1JaqBBj-xAQ1OuwZizj78BbTIZBWEd3kyouDEHcMO6z4W8iFhDRje6sUL93Sz7IoQs0dOdmPmdMyd5KfShS7hkxMQQckx5aGU4tEHqRKo_377mQJWI6XemLCzwB4_iLbs1ttDvW07o7K-QG_c8ZJdpO_zWVJtcLuDXmDPw9TgnLaEYmlDN7YXIokT2Jg9W3r9abIDCgQClT7C9g6cXicfpoeNkQ7FHBPiY7VeXjb65oXT78EgbLbQJQqbUi2Sd-kClBLP9Tbi8rdWpySYDEpyzFYAl8HVKbzO0uMkg3c8Tc9TMSWfo_h-vJIXEm0jpHHRQSRlHHR7ITZyxtuKEqkZwgeE-qzvYK37LKVNhKfiaQrMX15Q_4E64Aj0HEKTVkviTUkBFVSYsLb8s0YhrC_C7S2zOQxTp2FIgGvdC6EC4iHiRP3reHfpMREhMxQwR8JUGC-NfCFx0qeSOEDRok0WegPtFYZL-qljCELBmU8OYpN-Ip6dbmqTkJUfVCVSOevvtwYD2uVbWzwY2zTuKIURkVAEuxrFBjky52QYvC-L_etXXmBT99evRj2NyTamX5x1VZUhP7SC3UbzOOA148ZtEY8dM-O5fJtnVVmxdXyFkCzUre0YL5s3_MBRzkvNUnLFQvdxSmpE2HIhSmMkYd69m3nlMYZ_CZJgaFiL7IX28gZ59eizHf-6OdwTqIvCZOPENV5WNh_f3srnbEVENGvyHw51TqwpNp02cItumus9MfrQ3FJL1EQAimo72BWMGlcAYmsgoCAnNil2kV-8jNEP6UUsJP5HnS9zQEMgGxKQvHuUasw2g86gI3vLP8dV9_aEc4QNQmaLg65FFL0tuTMV3QajN0XOmJJog607QxMyDHC4xfJ06aEswqxgCvBSpUUi2BpoZaHa7Q-rbe27mg4TUBJhI-eFQNeg5JFzjDPFWukECJ6MG9s7UhwsmZBGjEuXrUax1bqg2OskIfm7rMSftHs8AxfbCM9VQcqdX3WG2qbCtdAPn0m5sN-kd0_4MrsIkE6QP3uXm2ujTQ-kPkjpKbeW56UF_TTpIXNqty1]--></g></svg>