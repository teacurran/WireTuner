<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="4423px" preserveAspectRatio="none" style="width:2776px;height:4423px;background:#FFFFFF;" version="1.1" viewBox="0 0 2776 4423" width="2776px" zoomAndPan="magnify"><title>Event Sourcing Lifecycle - Complete Flow from User Input to Replay</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="490.4922" x="1139.2034" y="28.5352">Event Sourcing Lifecycle - Complete Flow from User Input to Replay</text><rect fill="#ADD8E6" height="4374.3711" style="stroke:#181818;stroke-width:0.5;" width="454.7954" x="896.8657" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="189.0078" x="1029.7595" y="56.0566">Event Recording &amp; Sampling</text><rect fill="#90EE90" height="4374.3711" style="stroke:#181818;stroke-width:0.5;" width="448.3384" x="1410.3306" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="113.9912" x="1577.5042" y="56.0566">Event Processing</text><rect fill="#FFFFE0" height="4374.3711" style="stroke:#181818;stroke-width:0.5;" width="715.8848" x="1913.6567" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="116.981" x="2213.1086" y="56.0566">Persistence Layer</text><rect fill="none" height="355.9473" style="stroke:#000000;stroke-width:1.5;" width="787.5225" x="580.1387" y="239.2188"/><rect fill="none" height="251.0605" style="stroke:#000000;stroke-width:1.5;" width="466.7954" x="890.8657" y="292.8398"/><rect fill="none" height="377.9473" style="stroke:#000000;stroke-width:1.5;" width="2249.5435" x="10" y="1247.2402"/><rect fill="none" height="186.1289" style="stroke:#000000;stroke-width:1.5;" width="2041.1763" x="20" y="1432.0586"/><rect fill="none" height="616.7871" style="stroke:#000000;stroke-width:1.5;" width="1423.3599" x="1222.1816" y="1742.4297"/><rect fill="none" height="323.6816" style="stroke:#000000;stroke-width:1.5;" width="727.8848" x="1907.6567" y="2028.5352"/><rect fill="none" height="176.8633" style="stroke:#000000;stroke-width:1.5;" width="656.8457" x="1404.3306" y="2888.7383"/><rect fill="none" height="118.2422" style="stroke:#000000;stroke-width:1.5;" width="767.2349" x="1222.1816" y="3794.918"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="44.1826" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="48" x2="48" y1="118.9766" y2="4338.3711"/></g><g><title>Canvas Widget</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="208.7896" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="212.1641" x2="212.1641" y1="118.9766" y2="4338.3711"/></g><g><title>Tool Manager</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="434.3594" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="437.8613" x2="437.8613" y1="118.9766" y2="4338.3711"/></g><g><title>Active Tool</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="659.9292" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="663.1387" x2="663.1387" y1="118.9766" y2="4338.3711"/></g><g><title>Event Sampler</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="951.7241" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="954.8657" x2="954.8657" y1="118.9766" y2="4338.3711"/></g><g><title>Event Recorder</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="1285.9214" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1289.1816" x2="1289.1816" y1="118.9766" y2="4338.3711"/></g><g><title>Event Dispatcher</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="1474.2432" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1477.3306" x2="1477.3306" y1="118.9766" y2="4338.3711"/></g><g><title>Event Handler</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="1664.9136" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1668.8721" x2="1668.8721" y1="118.9766" y2="4338.3711"/></g><g><title>Document State</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="1789.812" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1792.9551" x2="1792.9551" y1="118.9766" y2="4338.3711"/></g><g><title>SQLite Repository</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="1980.4165" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1983.6567" x2="1983.6567" y1="118.9766" y2="4338.3711"/></g><g><title>Event Store</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="2200.5972" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2203.6509" x2="2203.6509" y1="118.9766" y2="4338.3711"/></g><g><title>Snapshot Manager</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="2375.9038" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2379.2388" x2="2379.2388" y1="118.9766" y2="4338.3711"/></g><g><title>Snapshot Store</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="2563.6582" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2566.7749" x2="2566.7749" y1="118.9766" y2="4338.3711"/></g><g><title>Canvas Renderer</title><rect fill="#000000" fill-opacity="0.00000" height="4219.3945" width="8" x="2695.4712" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2698.5415" x2="2698.5415" y1="118.9766" y2="4338.3711"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="30" y="116.0234">User</text><ellipse cx="48.1826" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M48.1826,58.9883 L48.1826,85.9883 M35.1826,66.9883 L61.1826,66.9883 M48.1826,85.9883 L35.1826,100.9883 M48.1826,85.9883 L61.1826,100.9883" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="30" y="4350.9063">User</text><ellipse cx="48.1826" cy="4362.3594" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M48.1826,4370.3594 L48.1826,4397.3594 M35.1826,4378.3594 L61.1826,4378.3594 M48.1826,4397.3594 L35.1826,4412.3594 M48.1826,4397.3594 L61.1826,4412.3594" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Canvas"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.251" x="156.1641" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.251" x="163.1641" y="108.0234">Canvas Widget</text></g><g class="participant participant-tail" data-participant="Canvas"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.251" x="156.1641" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.251" x="163.1641" y="4357.9063">Canvas Widget</text></g><g class="participant participant-head" data-participant="ToolMgr"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.9961" x="384.8613" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.9961" x="391.8613" y="108.0234">Tool Manager</text></g><g class="participant participant-tail" data-participant="ToolMgr"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.9961" x="384.8613" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.9961" x="391.8613" y="4357.9063">Tool Manager</text></g><g class="participant participant-head" data-participant="Tool"><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147.5811" x="590.1387" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.6875" x="626.0854" y="91.5352">Active Tool</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133.5811" x="597.1387" y="108.0234">(Pen/Selection/etc.)</text></g><g class="participant participant-tail" data-participant="Tool"><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147.5811" x="590.1387" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.6875" x="626.0854" y="4357.9063">Active Tool</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133.5811" x="597.1387" y="4374.3945">(Pen/Selection/etc.)</text></g><g class="participant participant-head" data-participant="Sampler"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109.7168" x="900.8657" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.7168" x="907.8657" y="108.0234">Event Sampler</text></g><g class="participant participant-tail" data-participant="Sampler"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109.7168" x="900.8657" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.7168" x="907.8657" y="4357.9063">Event Sampler</text></g><g class="participant participant-head" data-participant="Recorder"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.4795" x="1232.1816" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.4795" x="1239.1816" y="108.0234">Event Recorder</text></g><g class="participant participant-tail" data-participant="Recorder"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.4795" x="1232.1816" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.4795" x="1239.1816" y="4357.9063">Event Recorder</text></g><g class="participant participant-head" data-participant="Dispatcher"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.8252" x="1414.3306" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.8252" x="1421.3306" y="108.0234">Event Dispatcher</text></g><g class="participant participant-tail" data-participant="Dispatcher"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.8252" x="1414.3306" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.8252" x="1421.3306" y="4357.9063">Event Dispatcher</text></g><g class="participant participant-head" data-participant="Handlers"><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.083" x="1614.8721" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.083" x="1621.8721" y="91.5352">Event Handler</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.8447" x="1641.4912" y="108.0234">Registry</text></g><g class="participant participant-tail" data-participant="Handlers"><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.083" x="1614.8721" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.083" x="1621.8721" y="4357.9063">Event Handler</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.8447" x="1641.4912" y="4374.3945">Registry</text></g><g class="participant participant-head" data-participant="Doc"><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121.7139" x="1732.9551" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.7139" x="1739.9551" y="91.5352">Document State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.5938" x="1753.0151" y="108.0234">(Immutable)</text></g><g class="participant participant-tail" data-participant="Doc"><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121.7139" x="1732.9551" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.7139" x="1739.9551" y="4357.9063">Document State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.5938" x="1753.0151" y="4374.3945">(Immutable)</text></g><g class="participant participant-head" data-participant="Repo"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133.5195" x="1917.6567" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119.5195" x="1924.6567" y="108.0234">SQLite Repository</text></g><g class="participant participant-tail" data-participant="Repo"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133.5195" x="1917.6567" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119.5195" x="1924.6567" y="4357.9063">SQLite Repository</text></g><g class="participant participant-head" data-participant="EventStore"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89.8926" x="2159.6509" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.8926" x="2166.6509" y="108.0234">Event Store</text></g><g class="participant participant-tail" data-participant="EventStore"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89.8926" x="2159.6509" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.8926" x="2166.6509" y="4357.9063">Event Store</text></g><g class="participant participant-head" data-participant="SnapMgr"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139.3301" x="2310.2388" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.3301" x="2317.2388" y="108.0234">Snapshot Manager</text></g><g class="participant participant-tail" data-participant="SnapMgr"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139.3301" x="2310.2388" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.3301" x="2317.2388" y="4357.9063">Snapshot Manager</text></g><g class="participant participant-head" data-participant="SnapStore"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.7666" x="2509.7749" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.7666" x="2516.7749" y="108.0234">Snapshot Store</text></g><g class="participant participant-tail" data-participant="SnapStore"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.7666" x="2509.7749" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.7666" x="2516.7749" y="4357.9063">Snapshot Store</text></g><g class="participant participant-head" data-participant="Renderer"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.8594" x="2635.5415" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.8594" x="2642.5415" y="108.0234">Canvas Renderer</text></g><g class="participant participant-tail" data-participant="Renderer"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.8594" x="2635.5415" y="4337.3711"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.8594" x="2642.5415" y="4357.9063">Canvas Renderer</text></g><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="200.7896,161.5977,210.7896,165.5977,200.7896,169.5977,204.7896,165.5977" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48.1826" x2="206.7896" y1="165.5977" y2="165.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.0708" x="55.1826" y="145.5449">User interaction</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.6069" x="55.1826" y="160.8555">(click, drag, keyboard)</text></g><g class="message" data-participant-1="Canvas" data-participant-2="ToolMgr"><polygon fill="#181818" points="426.3594,190.9082,436.3594,194.9082,426.3594,198.9082,430.3594,194.9082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="212.7896" x2="432.3594" y1="194.9082" y2="194.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.5698" x="219.7896" y="190.166">onPointerDown/Move/Up(point)</text></g><g class="message" data-participant-1="ToolMgr" data-participant-2="Tool"><polygon fill="#181818" points="651.9292,220.2188,661.9292,224.2188,651.9292,228.2188,655.9292,224.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="438.3594" x2="657.9292" y1="224.2188" y2="224.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.5698" x="445.3594" y="219.4766">onPointerDown/Move/Up(point)</text></g><path d="M580.1387,239.2188 L642.2773,239.2188 L642.2773,246.5293 L632.2773,256.5293 L580.1387,256.5293 L580.1387,239.2188" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="355.9473" style="stroke:#000000;stroke-width:1.5;" width="787.5225" x="580.1387" y="239.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="595.1387" y="252.7871">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="236.1509" x="657.2773" y="251.8535">[High-frequency input (e.g., mouse drag)]</text><g class="message" data-participant-1="Tool" data-participant-2="Sampler"><polygon fill="#181818" points="943.7241,273.8398,953.7241,277.8398,943.7241,281.8398,947.7241,277.8398" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="663.9292" x2="949.7241" y1="277.8398" y2="277.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.7949" x="670.9292" y="273.0977">recordMove(objectId, position, timestamp)</text></g><path d="M890.8657,292.8398 L953.0044,292.8398 L953.0044,300.1504 L943.0044,310.1504 L890.8657,310.1504 L890.8657,292.8398" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="251.0605" style="stroke:#000000;stroke-width:1.5;" width="466.7954" x="890.8657" y="292.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="905.8657" y="306.4082">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="163.0288" x="968.0044" y="305.4746">[Within 50ms of last sample]</text><g class="message" data-participant-1="Sampler" data-participant-2="Sampler"><line style="stroke:#181818;stroke-width:1;" x1="955.7241" x2="997.7241" y1="346.7715" y2="346.7715"/><line style="stroke:#181818;stroke-width:1;" x1="997.7241" x2="997.7241" y1="346.7715" y2="359.7715"/><line style="stroke:#181818;stroke-width:1;" x1="956.7241" x2="997.7241" y1="359.7715" y2="359.7715"/><polygon fill="#181818" points="966.7241,355.7715,956.7241,359.7715,966.7241,363.7715,962.7241,359.7715" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.1831" x="962.7241" y="326.7188">Buffer movement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.6934" x="962.7241" y="342.0293">(throttle to 50ms)</text></g><path d="M960,372.7715 L960,427.7715 L1171,427.7715 L1171,382.7715 L1161,372.7715 L960,372.7715" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1161,372.7715 L1161,382.7715 L1171,382.7715 L1161,372.7715" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.4502" x="966" y="390.3398">Prevents event flood.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.2266" x="966" y="405.6504">Buffers intermediate positions</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.1758" x="966" y="420.9609">until 50ms threshold reached.</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="890.8657" x2="1357.6611" y1="434.7031" y2="434.7031"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="188.4932" x="895.8657" y="445.3379">[50ms elapsed since last sample]</text><g class="message" data-participant-1="Sampler" data-participant-2="Recorder"><polygon fill="#181818" points="1277.9214,465.9688,1287.9214,469.9688,1277.9214,473.9688,1281.9214,469.9688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="955.7241" x2="1283.9214" y1="469.9688" y2="469.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310.1973" x="962.7241" y="465.2266">recordEvent(MoveAnchorEvent/MoveObjectEvent)</text></g><path d="M960,482.9688 L960,537.9688 L1190,537.9688 L1190,492.9688 L1180,482.9688 L960,482.9688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1180,482.9688 L1180,492.9688 L1190,492.9688 L1180,482.9688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.1616" x="966" y="500.5371">Sampling reduces 2-second drag</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.7188" x="966" y="515.8477">from ~200 events to ~40 events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.3403" x="966" y="531.1582">(5x storage reduction)</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="580.1387" x2="1367.6611" y1="551.9004" y2="551.9004"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="189.2827" x="585.1387" y="562.5352">[Discrete input (e.g., single click)]</text><g class="message" data-participant-1="Tool" data-participant-2="Recorder"><polygon fill="#181818" points="1277.9214,583.166,1287.9214,587.166,1277.9214,591.166,1281.9214,587.166" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="663.9292" x2="1283.9214" y1="587.166" y2="587.166"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="326.0537" x="670.9292" y="582.4238">recordEvent(CreatePathEvent/AddAnchorEvent/etc.)</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Recorder"><line style="stroke:#181818;stroke-width:1;" x1="1289.9214" x2="1331.9214" y1="638.7871" y2="638.7871"/><line style="stroke:#181818;stroke-width:1;" x1="1331.9214" x2="1331.9214" y1="638.7871" y2="651.7871"/><line style="stroke:#181818;stroke-width:1;" x1="1290.9214" x2="1331.9214" y1="651.7871" y2="651.7871"/><polygon fill="#181818" points="1300.9214,647.7871,1290.9214,651.7871,1300.9214,655.7871,1296.9214,651.7871" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.7295" x="1296.9214" y="618.7344">Assign sequence number</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.2798" x="1296.9214" y="634.0449">(monotonic counter)</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Dispatcher"><polygon fill="#181818" points="1466.2432,677.0977,1476.2432,681.0977,1466.2432,685.0977,1470.2432,681.0977" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1289.9214" x2="1472.2432" y1="681.0977" y2="681.0977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.1162" x="1296.9214" y="676.3555">dispatch(event)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Handlers"><polygon fill="#181818" points="1656.9136,706.4082,1666.9136,710.4082,1656.9136,714.4082,1660.9136,710.4082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1478.2432" x2="1662.9136" y1="710.4082" y2="710.4082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.6704" x="1485.2432" y="705.666">lookupHandler(event.type)</text></g><g class="message" data-participant-1="Handlers" data-participant-2="Dispatcher"><polygon fill="#181818" points="1489.2432,735.7188,1479.2432,739.7188,1489.2432,743.7188,1485.2432,739.7188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1483.2432" x2="1667.9136" y1="739.7188" y2="739.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.6631" x="1495.2432" y="734.9766">Handler function</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Doc"><polygon fill="#181818" points="1781.812,765.0293,1791.812,769.0293,1781.812,773.0293,1785.812,769.0293" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1478.2432" x2="1787.812" y1="769.0293" y2="769.0293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.9395" x="1485.2432" y="764.2871">handler(currentDocument, event)</text></g><path d="M1798,782.0293 L1798,945.0293 L2094,945.0293 L2094,792.0293 L2084,782.0293 L1798,782.0293" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2084,782.0293 L2084,792.0293 L2094,792.0293 L2084,782.0293" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.3564" x="1804" y="799.5977">All domain models are immutable.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.5283" x="1804" y="814.9082">Event application is pure function:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.0146" x="1804" y="830.2188">(State, Event) &#8594; NewState</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1804" y="845.5293">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.0928" x="1804" y="860.8398">Example: AddAnchorEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.9595" x="1804" y="876.1504">1. Get path by ID from current doc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.4272" x="1804" y="891.4609">2. Create new Path with added anchor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.7739" x="1804" y="906.7715">3. Return new Document with updated path</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1804" y="922.082">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.8438" x="1804" y="937.3926">No in-place mutations.</text><g class="message" data-participant-1="Doc" data-participant-2="Doc"><line style="stroke:#181818;stroke-width:1;" x1="1793.812" x2="1835.812" y1="971.4453" y2="971.4453"/><line style="stroke:#181818;stroke-width:1;" x1="1835.812" x2="1835.812" y1="971.4453" y2="984.4453"/><line style="stroke:#181818;stroke-width:1;" x1="1794.812" x2="1835.812" y1="984.4453" y2="984.4453"/><polygon fill="#181818" points="1804.812,980.4453,1794.812,984.4453,1804.812,988.4453,1800.812,984.4453" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.6045" x="1800.812" y="966.7031">Create new immutable state</text></g><g class="message" data-participant-1="Doc" data-participant-2="Dispatcher"><polygon fill="#181818" points="1489.2432,1009.7559,1479.2432,1013.7559,1489.2432,1017.7559,1485.2432,1013.7559" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1483.2432" x2="1792.812" y1="1013.7559" y2="1013.7559"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.6221" x="1495.2432" y="1009.0137">New Document state</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Recorder"><polygon fill="#181818" points="1300.9214,1039.0664,1290.9214,1043.0664,1300.9214,1047.0664,1296.9214,1043.0664" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1294.9214" x2="1477.2432" y1="1043.0664" y2="1043.0664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.3218" x="1306.9214" y="1038.3242">Event applied successfully</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Repo"><polygon fill="#181818" points="1972.4165,1068.377,1982.4165,1072.377,1972.4165,1076.377,1976.4165,1072.377" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1289.9214" x2="1978.4165" y1="1072.377" y2="1072.377"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.4233" x="1296.9214" y="1067.6348">insertEvent(event)</text></g><g class="message" data-participant-1="Repo" data-participant-2="Repo"><line style="stroke:#181818;stroke-width:1;" x1="1984.4165" x2="2026.4165" y1="1101.6875" y2="1101.6875"/><line style="stroke:#181818;stroke-width:1;" x1="2026.4165" x2="2026.4165" y1="1101.6875" y2="1114.6875"/><line style="stroke:#181818;stroke-width:1;" x1="1985.4165" x2="2026.4165" y1="1114.6875" y2="1114.6875"/><polygon fill="#181818" points="1995.4165,1110.6875,1985.4165,1114.6875,1995.4165,1118.6875,1991.4165,1114.6875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.7905" x="1991.4165" y="1096.9453">Serialize event to JSON</text></g><g class="message" data-participant-1="Repo" data-participant-2="EventStore"><polygon fill="#181818" points="2192.5972,1170.6191,2202.5972,1174.6191,2192.5972,1178.6191,2196.5972,1174.6191" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1984.4165" x2="2198.5972" y1="1174.6191" y2="1174.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5029" x="1991.4165" y="1139.2559">INSERT INTO events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.2661" x="1991.4165" y="1154.5664">(event_sequence, event_type,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.5845" x="1991.4165" y="1169.877">event_payload, created_at)</text></g><g class="message" data-participant-1="EventStore" data-participant-2="EventStore"><line style="stroke:#181818;stroke-width:1;" x1="2204.5972" x2="2246.5972" y1="1219.2402" y2="1219.2402"/><line style="stroke:#181818;stroke-width:1;" x1="2246.5972" x2="2246.5972" y1="1219.2402" y2="1232.2402"/><line style="stroke:#181818;stroke-width:1;" x1="2205.5972" x2="2246.5972" y1="1232.2402" y2="1232.2402"/><polygon fill="#181818" points="2215.5972,1228.2402,2205.5972,1232.2402,2215.5972,1236.2402,2211.5972,1232.2402" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.5752" x="2211.5972" y="1199.1875">SQLite transaction</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.3066" x="2211.5972" y="1214.498">(WAL mode for durability)</text></g><path d="M10,1247.2402 L72.1387,1247.2402 L72.1387,1254.5508 L62.1387,1264.5508 L10,1264.5508 L10,1247.2402" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="377.9473" style="stroke:#000000;stroke-width:1.5;" width="2249.5435" x="10" y="1247.2402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="25" y="1260.8086">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="104.1724" x="87.1387" y="1259.875">[Insert successful]</text><g class="message" data-participant-1="EventStore" data-participant-2="Repo"><polygon fill="#181818" points="1995.4165,1281.8613,1985.4165,1285.8613,1995.4165,1289.8613,1991.4165,1285.8613" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1989.4165" x2="2203.5972" y1="1285.8613" y2="1285.8613"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.8833" x="2001.4165" y="1281.1191">Success</text></g><g class="message" data-participant-1="Repo" data-participant-2="Recorder"><polygon fill="#181818" points="1300.9214,1311.1719,1290.9214,1315.1719,1300.9214,1319.1719,1296.9214,1315.1719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1294.9214" x2="1983.4165" y1="1315.1719" y2="1315.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.9409" x="1306.9214" y="1310.4297">Event persisted (sequence #N)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="2259.5435" y1="1324.1719" y2="1324.1719"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="88.2954" x="15" y="1334.8066">[Disk full error]</text><g class="message" data-participant-1="EventStore" data-participant-2="Repo"><polygon fill="#181818" points="1995.4165,1355.4375,1985.4165,1359.4375,1995.4165,1363.4375,1991.4165,1359.4375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1989.4165" x2="2203.5972" y1="1359.4375" y2="1359.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.6831" x="2001.4165" y="1354.6953">SQLITE_FULL error</text></g><g class="message" data-participant-1="Repo" data-participant-2="Repo"><line style="stroke:#181818;stroke-width:1;" x1="1984.4165" x2="2026.4165" y1="1404.0586" y2="1404.0586"/><line style="stroke:#181818;stroke-width:1;" x1="2026.4165" x2="2026.4165" y1="1404.0586" y2="1417.0586"/><line style="stroke:#181818;stroke-width:1;" x1="1985.4165" x2="2026.4165" y1="1417.0586" y2="1417.0586"/><polygon fill="#181818" points="1995.4165,1413.0586,1985.4165,1417.0586,1995.4165,1421.0586,1991.4165,1417.0586" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.5308" x="1991.4165" y="1384.0059">Retry with backoff</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.9609" x="1991.4165" y="1399.3164">(50ms, 100ms, 200ms)</text></g><path d="M20,1432.0586 L82.1387,1432.0586 L82.1387,1439.3691 L72.1387,1449.3691 L20,1449.3691 L20,1432.0586" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="186.1289" style="stroke:#000000;stroke-width:1.5;" width="2041.1763" x="20" y="1432.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="35" y="1445.627">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="101.084" x="97.1387" y="1444.6934">[Retry successful]</text><g class="message" data-participant-1="Repo" data-participant-2="Recorder"><polygon fill="#181818" points="1300.9214,1466.6797,1290.9214,1470.6797,1300.9214,1474.6797,1296.9214,1470.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1294.9214" x2="1983.4165" y1="1470.6797" y2="1470.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.1035" x="1306.9214" y="1465.9375">Event persisted</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="20" x2="2061.1763" y1="1479.6797" y2="1479.6797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99.7197" x="25" y="1490.3145">[All retries failed]</text><g class="message" data-participant-1="Repo" data-participant-2="Recorder"><polygon fill="#181818" points="1300.9214,1510.9453,1290.9214,1514.9453,1300.9214,1518.9453,1296.9214,1514.9453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1294.9214" x2="1983.4165" y1="1514.9453" y2="1514.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.4126" x="1306.9214" y="1510.2031">Error: Disk full</text></g><g class="message" data-participant-1="Recorder" data-participant-2="User"><polygon fill="#181818" points="59.1826,1555.5664,49.1826,1559.5664,59.1826,1563.5664,55.1826,1559.5664" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="53.1826" x2="1288.9214" y1="1559.5664" y2="1559.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.6616" x="65.1826" y="1539.5137">Surface error:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.1499" x="65.1826" y="1554.8242">"Cannot save - disk full"</text></g><path d="M1294,1572.5664 L1294,1612.5664 L1524,1612.5664 L1524,1582.5664 L1514,1572.5664 L1294,1572.5664" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1514,1572.5664 L1514,1582.5664 L1524,1582.5664 L1514,1572.5664" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.4731" x="1300" y="1590.1348">Enter read-only mode,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.5298" x="1300" y="1605.4453">allow export to alternate location</text><g class="message" data-participant-1="Recorder" data-participant-2="Canvas"><polygon fill="#181818" points="223.7896,1664.8086,213.7896,1668.8086,223.7896,1672.8086,219.7896,1668.8086" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="217.7896" x2="1288.9214" y1="1668.8086" y2="1668.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.3784" x="229.7896" y="1648.7559">notifyListeners()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.2002" x="229.7896" y="1664.0664">(Flutter Provider pattern)</text></g><g class="message" data-participant-1="Canvas" data-participant-2="Renderer"><polygon fill="#181818" points="2687.4712,1694.1191,2697.4712,1698.1191,2687.4712,1702.1191,2691.4712,1698.1191" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="212.7896" x2="2693.4712" y1="1698.1191" y2="1698.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.7559" x="219.7896" y="1693.377">build() &#8594; paint(NewDocument)</text></g><g class="message" data-participant-1="Renderer" data-participant-2="User"><polygon fill="#181818" points="59.1826,1723.4297,49.1826,1727.4297,59.1826,1731.4297,55.1826,1727.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.1826" x2="2698.4712" y1="1727.4297" y2="1727.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5986" x="65.1826" y="1722.6875">Display updated canvas</text></g><path d="M1222.1816,1742.4297 L1284.3203,1742.4297 L1284.3203,1749.7402 L1274.3203,1759.7402 L1222.1816,1759.7402 L1222.1816,1742.4297" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="616.7871" style="stroke:#000000;stroke-width:1.5;" width="1423.3599" x="1222.1816" y="1742.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="1237.1816" y="1755.998">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="253.7842" x="1299.3203" y="1755.0645">[Event count milestone (1000, 2000, 3000...)]</text><g class="message" data-participant-1="Recorder" data-participant-2="SnapMgr"><polygon fill="#181818" points="2367.9038,1777.0508,2377.9038,1781.0508,2367.9038,1785.0508,2371.9038,1781.0508" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1289.9214" x2="2373.9038" y1="1781.0508" y2="1781.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.3584" x="1296.9214" y="1776.3086">onEventMilestone(sequence: N)</text></g><g class="message" data-participant-1="SnapMgr" data-participant-2="Doc"><polygon fill="#181818" points="1804.812,1806.3613,1794.812,1810.3613,1804.812,1814.3613,1800.812,1810.3613" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1798.812" x2="2378.9038" y1="1810.3613" y2="1810.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.2988" x="1810.812" y="1805.6191">getCurrentDocument()</text></g><g class="message" data-participant-1="Doc" data-participant-2="SnapMgr"><polygon fill="#181818" points="2367.9038,1835.6719,2377.9038,1839.6719,2367.9038,1843.6719,2371.9038,1839.6719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1793.812" x2="2373.9038" y1="1839.6719" y2="1839.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.0776" x="1800.812" y="1834.9297">Current document state</text></g><g class="message" data-participant-1="SnapMgr" data-participant-2="SnapMgr"><line style="stroke:#181818;stroke-width:1;" x1="2379.9038" x2="2421.9038" y1="1868.9824" y2="1868.9824"/><line style="stroke:#181818;stroke-width:1;" x1="2421.9038" x2="2421.9038" y1="1868.9824" y2="1881.9824"/><line style="stroke:#181818;stroke-width:1;" x1="2380.9038" x2="2421.9038" y1="1881.9824" y2="1881.9824"/><polygon fill="#181818" points="2390.9038,1877.9824,2380.9038,1881.9824,2390.9038,1885.9824,2386.9038,1881.9824" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.8501" x="2386.9038" y="1864.2402">Serialize document to JSON</text></g><g class="message" data-participant-1="SnapMgr" data-participant-2="SnapMgr"><line style="stroke:#181818;stroke-width:1;" x1="2379.9038" x2="2421.9038" y1="1926.6035" y2="1926.6035"/><line style="stroke:#181818;stroke-width:1;" x1="2421.9038" x2="2421.9038" y1="1926.6035" y2="1939.6035"/><line style="stroke:#181818;stroke-width:1;" x1="2380.9038" x2="2421.9038" y1="1939.6035" y2="1939.6035"/><polygon fill="#181818" points="2390.9038,1935.6035,2380.9038,1939.6035,2390.9038,1943.6035,2386.9038,1939.6035" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.5439" x="2386.9038" y="1906.5508">Compress with gzip</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.1523" x="2386.9038" y="1921.8613">(~10:1 compression)</text></g><g class="message" data-participant-1="SnapMgr" data-participant-2="Repo"><polygon fill="#181818" points="1995.4165,1964.9141,1985.4165,1968.9141,1995.4165,1972.9141,1991.4165,1968.9141" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1989.4165" x2="2378.9038" y1="1968.9141" y2="1968.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310.6162" x="2001.4165" y="1964.1719">createSnapshot(eventSequence, compressedBlob)</text></g><g class="message" data-participant-1="Repo" data-participant-2="SnapStore"><polygon fill="#181818" points="2555.6582,2009.5352,2565.6582,2013.5352,2555.6582,2017.5352,2559.6582,2013.5352" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1984.4165" x2="2561.6582" y1="2013.5352" y2="2013.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.9575" x="1991.4165" y="1993.4824">INSERT INTO snapshots</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.1587" x="1991.4165" y="2008.793">(event_sequence, snapshot_data)</text></g><path d="M1907.6567,2028.5352 L1969.7954,2028.5352 L1969.7954,2035.8457 L1959.7954,2045.8457 L1907.6567,2045.8457 L1907.6567,2028.5352" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="323.6816" style="stroke:#000000;stroke-width:1.5;" width="727.8848" x="1907.6567" y="2028.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="1922.6567" y="2042.1035">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="173.0459" x="1984.7954" y="2041.1699">[Snapshot creation successful]</text><g class="message" data-participant-1="SnapStore" data-participant-2="Repo"><polygon fill="#181818" points="1995.4165,2063.1563,1985.4165,2067.1563,1995.4165,2071.1563,1991.4165,2067.1563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1989.4165" x2="2566.6582" y1="2067.1563" y2="2067.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.8833" x="2001.4165" y="2062.4141">Success</text></g><g class="message" data-participant-1="Repo" data-participant-2="SnapMgr"><polygon fill="#181818" points="2367.9038,2092.4668,2377.9038,2096.4668,2367.9038,2100.4668,2371.9038,2096.4668" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1984.4165" x2="2373.9038" y1="2096.4668" y2="2096.4668"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.7734" x="1991.4165" y="2091.7246">Snapshot created</text></g><path d="M2384,2109.4668 L2384,2164.4668 L2610,2164.4668 L2610,2119.4668 L2600,2109.4668 L2384,2109.4668" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2600,2109.4668 L2600,2119.4668 L2610,2119.4668 L2600,2109.4668" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.3687" x="2390" y="2127.0352">Latency budget: &lt; 25ms</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.98" x="2390" y="2142.3457">Snapshot size: ~10-50KB</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.9053" x="2390" y="2157.6563">Keeps 10 most recent snapshots</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1907.6567" x2="2635.5415" y1="2171.3984" y2="2171.3984"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="171.9448" x="1912.6567" y="2182.0332">[Disk full / Serialization error]</text><g class="message" data-participant-1="SnapStore" data-participant-2="Repo"><polygon fill="#181818" points="1995.4165,2202.6641,1985.4165,2206.6641,1995.4165,2210.6641,1991.4165,2206.6641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1989.4165" x2="2566.6582" y1="2206.6641" y2="2206.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30.9893" x="2001.4165" y="2201.9219">Error</text></g><g class="message" data-participant-1="Repo" data-participant-2="SnapMgr"><polygon fill="#181818" points="2367.9038,2231.9746,2377.9038,2235.9746,2367.9038,2239.9746,2371.9038,2235.9746" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1984.4165" x2="2373.9038" y1="2235.9746" y2="2235.9746"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.9858" x="1991.4165" y="2231.2324">Snapshot failed</text></g><g class="message" data-participant-1="SnapMgr" data-participant-2="SnapMgr"><line style="stroke:#181818;stroke-width:1;" x1="2379.9038" x2="2421.9038" y1="2265.2852" y2="2265.2852"/><line style="stroke:#181818;stroke-width:1;" x1="2421.9038" x2="2421.9038" y1="2265.2852" y2="2278.2852"/><line style="stroke:#181818;stroke-width:1;" x1="2380.9038" x2="2421.9038" y1="2278.2852" y2="2278.2852"/><polygon fill="#181818" points="2390.9038,2274.2852,2380.9038,2278.2852,2390.9038,2282.2852,2386.9038,2278.2852" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.7544" x="2386.9038" y="2260.543">Log warning, skip snapshot</text></g><path d="M2384,2291.2852 L2384,2346.2852 L2581,2346.2852 L2581,2301.2852 L2571,2291.2852 L2384,2291.2852" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2571,2291.2852 L2571,2301.2852 L2581,2301.2852 L2571,2291.2852" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.668" x="2390" y="2308.8535">Snapshots are optimization,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.4985" x="2390" y="2324.1641">not critical path.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.1694" x="2390" y="2339.4746">Continue event recording.</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2769.8989" x="0" y="2386.8721"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2769.8989" y1="2386.8721" y2="2386.8721"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2769.8989" y1="2389.8721" y2="2389.8721"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="158.2822" x="1305.8083" y="2376.2168"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="139.9976" x="1311.8083" y="2392.7852">Document Load Flow</text><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="200.7896,2426.8379,210.7896,2430.8379,200.7896,2434.8379,204.7896,2430.8379" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48.1826" x2="206.7896" y1="2430.8379" y2="2430.8379"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.3662" x="55.1826" y="2426.0957">Open .wiretuner file</text></g><g class="message" data-participant-1="Canvas" data-participant-2="Repo"><polygon fill="#181818" points="1972.4165,2456.1484,1982.4165,2460.1484,1972.4165,2464.1484,1976.4165,2460.1484" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="212.7896" x2="1978.4165" y1="2460.1484" y2="2460.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.1514" x="219.7896" y="2455.4063">loadDocument(filePath)</text></g><g class="message" data-participant-1="Repo" data-participant-2="EventStore"><polygon fill="#181818" points="2192.5972,2500.7695,2202.5972,2504.7695,2192.5972,2508.7695,2196.5972,2504.7695" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1984.4165" x2="2198.5972" y1="2504.7695" y2="2504.7695"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.0879" x="1991.4165" y="2484.7168">SELECT MAX(event_sequence)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.3706" x="1991.4165" y="2500.0273">FROM events</text></g><g class="message" data-participant-1="EventStore" data-participant-2="Repo"><polygon fill="#181818" points="1995.4165,2530.0801,1985.4165,2534.0801,1995.4165,2538.0801,1991.4165,2534.0801" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1989.4165" x2="2203.5972" y1="2534.0801" y2="2534.0801"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.1592" x="2001.4165" y="2529.3379">maxSequence = N</text></g><g class="message" data-participant-1="Repo" data-participant-2="SnapStore"><polygon fill="#181818" points="2555.6582,2620.6328,2565.6582,2624.6328,2555.6582,2628.6328,2559.6582,2624.6328" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1984.4165" x2="2561.6582" y1="2624.6328" y2="2624.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.0566" x="1991.4165" y="2558.6484">SELECT snapshot_data, event_sequence</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.8252" x="1991.4165" y="2573.959">FROM snapshots</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.5737" x="1991.4165" y="2589.2695">WHERE event_sequence &lt;= N</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.9946" x="1991.4165" y="2604.5801">ORDER BY event_sequence DESC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46.1729" x="1991.4165" y="2619.8906">LIMIT 1</text></g><g class="message" data-participant-1="SnapStore" data-participant-2="Repo"><polygon fill="#181818" points="1995.4165,2665.2539,1985.4165,2669.2539,1995.4165,2673.2539,1991.4165,2669.2539" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1989.4165" x2="2566.6582" y1="2669.2539" y2="2669.2539"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.9966" x="2001.4165" y="2649.2012">Snapshot at sequence M,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.3027" x="2001.4165" y="2664.5117">compressed BLOB</text></g><g class="message" data-participant-1="Repo" data-participant-2="Repo"><line style="stroke:#181818;stroke-width:1;" x1="1984.4165" x2="2026.4165" y1="2713.875" y2="2713.875"/><line style="stroke:#181818;stroke-width:1;" x1="2026.4165" x2="2026.4165" y1="2713.875" y2="2726.875"/><line style="stroke:#181818;stroke-width:1;" x1="1985.4165" x2="2026.4165" y1="2726.875" y2="2726.875"/><polygon fill="#181818" points="1995.4165,2722.875,1985.4165,2726.875,1995.4165,2730.875,1991.4165,2726.875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.4707" x="1991.4165" y="2693.8223">Decompress snapshot</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9277" x="1991.4165" y="2709.1328">(gzip &#8594; JSON)</text></g><g class="message" data-participant-1="Repo" data-participant-2="Repo"><line style="stroke:#181818;stroke-width:1;" x1="1984.4165" x2="2026.4165" y1="2756.1855" y2="2756.1855"/><line style="stroke:#181818;stroke-width:1;" x1="2026.4165" x2="2026.4165" y1="2756.1855" y2="2769.1855"/><line style="stroke:#181818;stroke-width:1;" x1="1985.4165" x2="2026.4165" y1="2769.1855" y2="2769.1855"/><polygon fill="#181818" points="1995.4165,2765.1855,1985.4165,2769.1855,1995.4165,2773.1855,1991.4165,2769.1855" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.1631" x="1991.4165" y="2751.4434">Deserialize JSON &#8594; Document</text></g><g class="message" data-participant-1="Repo" data-participant-2="EventStore"><polygon fill="#181818" points="2192.5972,2825.1172,2202.5972,2829.1172,2192.5972,2833.1172,2196.5972,2829.1172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1984.4165" x2="2198.5972" y1="2829.1172" y2="2829.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.1021" x="1991.4165" y="2793.7539">SELECT * FROM events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.833" x="1991.4165" y="2809.0645">WHERE event_sequence &gt; M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.1807" x="1991.4165" y="2824.375">ORDER BY event_sequence ASC</text></g><g class="message" data-participant-1="EventStore" data-participant-2="Repo"><polygon fill="#181818" points="1995.4165,2869.7383,1985.4165,2873.7383,1995.4165,2877.7383,1991.4165,2873.7383" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1989.4165" x2="2203.5972" y1="2873.7383" y2="2873.7383"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.1172" x="2001.4165" y="2853.6855">Events M+1 to N</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.5444" x="2001.4165" y="2868.9961">(up to 1000 events)</text></g><path d="M1404.3306,2888.7383 L1478.7773,2888.7383 L1478.7773,2896.0488 L1468.7773,2906.0488 L1404.3306,2906.0488 L1404.3306,2888.7383" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="176.8633" style="stroke:#000000;stroke-width:1.5;" width="656.8457" x="1404.3306" y="2888.7383"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="1419.3306" y="2902.3066">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="155.7939" x="1493.7773" y="2901.373">[For each event (M+1 to N)]</text><g class="message" data-participant-1="Repo" data-participant-2="Dispatcher"><polygon fill="#181818" points="1489.2432,2923.3594,1479.2432,2927.3594,1489.2432,2931.3594,1485.2432,2927.3594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1483.2432" x2="1983.4165" y1="2927.3594" y2="2927.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.1162" x="1495.2432" y="2922.6172">dispatch(event)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Handlers"><polygon fill="#181818" points="1656.9136,2952.6699,1666.9136,2956.6699,1656.9136,2960.6699,1660.9136,2956.6699" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1478.2432" x2="1662.9136" y1="2956.6699" y2="2956.6699"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.6704" x="1485.2432" y="2951.9277">lookupHandler(event.type)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Doc"><polygon fill="#181818" points="1781.812,2981.9805,1791.812,2985.9805,1781.812,2989.9805,1785.812,2985.9805" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1478.2432" x2="1787.812" y1="2985.9805" y2="2985.9805"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8462" x="1485.2432" y="2981.2383">handler(document, event)</text></g><g class="message" data-participant-1="Doc" data-participant-2="Doc"><line style="stroke:#181818;stroke-width:1;" x1="1793.812" x2="1835.812" y1="3015.291" y2="3015.291"/><line style="stroke:#181818;stroke-width:1;" x1="1835.812" x2="1835.812" y1="3015.291" y2="3028.291"/><line style="stroke:#181818;stroke-width:1;" x1="1794.812" x2="1835.812" y1="3028.291" y2="3028.291"/><polygon fill="#181818" points="1804.812,3024.291,1794.812,3028.291,1804.812,3032.291,1800.812,3028.291" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.1172" x="1800.812" y="3010.5488">Apply event &#8594; New state</text></g><g class="message" data-participant-1="Doc" data-participant-2="Dispatcher"><polygon fill="#181818" points="1489.2432,3053.6016,1479.2432,3057.6016,1489.2432,3061.6016,1485.2432,3057.6016" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1483.2432" x2="1792.812" y1="3057.6016" y2="3057.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.1548" x="1495.2432" y="3052.8594">Updated document</text></g><path d="M1989,3077.6016 L1989,3194.6016 L2289,3194.6016 L2289,3087.6016 L2279,3077.6016 L1989,3077.6016" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2279,3077.6016 L2279,3087.6016 L2289,3087.6016 L2279,3077.6016" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.5889" x="1995" y="3095.1699">Latency budget: &lt; 200ms</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1995" y="3110.4805">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.0356" x="1995" y="3125.791">Typical: Snapshot + 100-500 events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.0366" x="1995" y="3141.1016">Worst case: 1000 events between snapshots</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1995" y="3156.4121">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.5933" x="1995" y="3171.7227">Optimization: Viewport culling,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.8008" x="1995" y="3187.0332">lazy rendering during replay</text><g class="message" data-participant-1="Repo" data-participant-2="Canvas"><polygon fill="#181818" points="223.7896,3217.0859,213.7896,3221.0859,223.7896,3225.0859,219.7896,3221.0859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="217.7896" x2="1983.4165" y1="3221.0859" y2="3221.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.936" x="229.7896" y="3216.3438">Final document state</text></g><g class="message" data-participant-1="Canvas" data-participant-2="Renderer"><polygon fill="#181818" points="2687.4712,3246.3965,2697.4712,3250.3965,2687.4712,3254.3965,2691.4712,3250.3965" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="212.7896" x2="2693.4712" y1="3250.3965" y2="3250.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.2632" x="219.7896" y="3245.6543">paint(Document)</text></g><g class="message" data-participant-1="Renderer" data-participant-2="User"><polygon fill="#181818" points="59.1826,3275.707,49.1826,3279.707,59.1826,3283.707,55.1826,3279.707" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.1826" x2="2698.4712" y1="3279.707" y2="3279.707"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.9927" x="65.1826" y="3274.9648">Display loaded document</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2769.8989" x="0" y="3308.3623"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2769.8989" y1="3308.3623" y2="3308.3623"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2769.8989" y1="3311.3623" y2="3311.3623"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="187.5386" x="1291.1802" y="3297.707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="169.2539" x="1297.1802" y="3314.2754">Undo Operation (Cmd+Z)</text><g class="message" data-participant-1="User" data-participant-2="Canvas"><polygon fill="#181818" points="200.7896,3348.3281,210.7896,3352.3281,200.7896,3356.3281,204.7896,3352.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48.1826" x2="206.7896" y1="3352.3281" y2="3352.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.4316" x="55.1826" y="3347.5859">Press Cmd+Z (Undo)</text></g><g class="message" data-participant-1="Canvas" data-participant-2="Recorder"><polygon fill="#181818" points="1277.9214,3377.6387,1287.9214,3381.6387,1277.9214,3385.6387,1281.9214,3381.6387" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="212.7896" x2="1283.9214" y1="3381.6387" y2="3381.6387"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.7583" x="219.7896" y="3376.8965">undo()</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Recorder"><line style="stroke:#181818;stroke-width:1;" x1="1289.9214" x2="1331.9214" y1="3426.2598" y2="3426.2598"/><line style="stroke:#181818;stroke-width:1;" x1="1331.9214" x2="1331.9214" y1="3426.2598" y2="3439.2598"/><line style="stroke:#181818;stroke-width:1;" x1="1290.9214" x2="1331.9214" y1="3439.2598" y2="3439.2598"/><polygon fill="#181818" points="1300.9214,3435.2598,1290.9214,3439.2598,1300.9214,3443.2598,1296.9214,3439.2598" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.4087" x="1296.9214" y="3406.207">currentSequence = N</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.4111" x="1296.9214" y="3421.5176">targetSequence = N - 1</text></g><g class="message" data-participant-1="Recorder" data-participant-2="SnapStore"><polygon fill="#181818" points="2555.6582,3495.1914,2565.6582,3499.1914,2555.6582,3503.1914,2559.6582,3499.1914" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1289.9214" x2="2561.6582" y1="3499.1914" y2="3499.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.0879" x="1296.9214" y="3463.8281">SELECT MAX(event_sequence)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.8252" x="1296.9214" y="3479.1387">FROM snapshots</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.771" x="1296.9214" y="3494.4492">WHERE event_sequence &lt;= (N-1)</text></g><g class="message" data-participant-1="SnapStore" data-participant-2="Recorder"><polygon fill="#181818" points="1300.9214,3524.502,1290.9214,3528.502,1300.9214,3532.502,1296.9214,3528.502" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1294.9214" x2="2566.6582" y1="3528.502" y2="3528.502"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.0625" x="1306.9214" y="3523.7598">snapshotSequence = M</text></g><g class="message" data-participant-1="Recorder" data-participant-2="SnapStore"><polygon fill="#181818" points="2555.6582,3584.4336,2565.6582,3588.4336,2555.6582,3592.4336,2559.6582,3588.4336" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1289.9214" x2="2561.6582" y1="3588.4336" y2="3588.4336"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.8545" x="1296.9214" y="3553.0703">SELECT snapshot_data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.8252" x="1296.9214" y="3568.3809">FROM snapshots</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.833" x="1296.9214" y="3583.6914">WHERE event_sequence = M</text></g><g class="message" data-participant-1="SnapStore" data-participant-2="Recorder"><polygon fill="#181818" points="1300.9214,3613.7441,1290.9214,3617.7441,1300.9214,3621.7441,1296.9214,3617.7441" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1294.9214" x2="2566.6582" y1="3617.7441" y2="3617.7441"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.0723" x="1306.9214" y="3613.002">Snapshot BLOB</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Recorder"><line style="stroke:#181818;stroke-width:1;" x1="1289.9214" x2="1331.9214" y1="3662.3652" y2="3662.3652"/><line style="stroke:#181818;stroke-width:1;" x1="1331.9214" x2="1331.9214" y1="3662.3652" y2="3675.3652"/><line style="stroke:#181818;stroke-width:1;" x1="1290.9214" x2="1331.9214" y1="3675.3652" y2="3675.3652"/><polygon fill="#181818" points="1300.9214,3671.3652,1290.9214,3675.3652,1300.9214,3679.3652,1296.9214,3675.3652" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.0283" x="1296.9214" y="3642.3125">Deserialize snapshot</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.5117" x="1296.9214" y="3657.623">&#8594; Base Document</text></g><g class="message" data-participant-1="Recorder" data-participant-2="EventStore"><polygon fill="#181818" points="2192.5972,3746.6074,2202.5972,3750.6074,2192.5972,3754.6074,2196.5972,3750.6074" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1289.9214" x2="2198.5972" y1="3750.6074" y2="3750.6074"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.1021" x="1296.9214" y="3699.9336">SELECT * FROM events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.833" x="1296.9214" y="3715.2441">WHERE event_sequence &gt; M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.0952" x="1296.9214" y="3730.5547">AND event_sequence &lt;= (N-1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.1807" x="1296.9214" y="3745.8652">ORDER BY event_sequence ASC</text></g><g class="message" data-participant-1="EventStore" data-participant-2="Recorder"><polygon fill="#181818" points="1300.9214,3775.918,1290.9214,3779.918,1300.9214,3783.918,1296.9214,3779.918" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1294.9214" x2="2203.5972" y1="3779.918" y2="3779.918"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.8594" x="1306.9214" y="3775.1758">Events M+1 to N-1</text></g><path d="M1222.1816,3794.918 L1296.6284,3794.918 L1296.6284,3802.2285 L1286.6284,3812.2285 L1222.1816,3812.2285 L1222.1816,3794.918" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="118.2422" style="stroke:#000000;stroke-width:1.5;" width="767.2349" x="1222.1816" y="3794.918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="1237.1816" y="3808.4863">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="170.0757" x="1311.6284" y="3807.5527">[For each event (M+1 to N-1)]</text><g class="message" data-participant-1="Recorder" data-participant-2="Dispatcher"><polygon fill="#181818" points="1466.2432,3829.5391,1476.2432,3833.5391,1466.2432,3837.5391,1470.2432,3833.5391" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1289.9214" x2="1472.2432" y1="3833.5391" y2="3833.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.1162" x="1296.9214" y="3828.7969">dispatch(event)</text></g><g class="message" data-participant-1="Dispatcher" data-participant-2="Doc"><polygon fill="#181818" points="1781.812,3858.8496,1791.812,3862.8496,1781.812,3866.8496,1785.812,3862.8496" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1478.2432" x2="1787.812" y1="3862.8496" y2="3862.8496"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.6396" x="1485.2432" y="3858.1074">applyEvent(event)</text></g><g class="message" data-participant-1="Doc" data-participant-2="Doc"><line style="stroke:#181818;stroke-width:1;" x1="1793.812" x2="1835.812" y1="3892.1602" y2="3892.1602"/><line style="stroke:#181818;stroke-width:1;" x1="1835.812" x2="1835.812" y1="3892.1602" y2="3905.1602"/><line style="stroke:#181818;stroke-width:1;" x1="1794.812" x2="1835.812" y1="3905.1602" y2="3905.1602"/><polygon fill="#181818" points="1804.812,3901.1602,1794.812,3905.1602,1804.812,3909.1602,1800.812,3905.1602" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.6045" x="1800.812" y="3887.418">Create new immutable state</text></g><g class="message" data-participant-1="Recorder" data-participant-2="Canvas"><polygon fill="#181818" points="223.7896,3952.7813,213.7896,3956.7813,223.7896,3960.7813,219.7896,3956.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="217.7896" x2="1288.9214" y1="3956.7813" y2="3956.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.2129" x="229.7896" y="3936.7285">setDocument(documentAtN-1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.0444" x="229.7896" y="3952.0391">currentSequence: N-1)</text></g><g class="message" data-participant-1="Canvas" data-participant-2="Renderer"><polygon fill="#181818" points="2687.4712,3982.0918,2697.4712,3986.0918,2687.4712,3990.0918,2691.4712,3986.0918" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="212.7896" x2="2693.4712" y1="3986.0918" y2="3986.0918"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.2632" x="219.7896" y="3981.3496">paint(Document)</text></g><g class="message" data-participant-1="Renderer" data-participant-2="User"><polygon fill="#181818" points="59.1826,4026.7129,49.1826,4030.7129,59.1826,4034.7129,55.1826,4030.7129" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.1826" x2="2698.4712" y1="4030.7129" y2="4030.7129"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.168" x="65.1826" y="4010.6602">Display document with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.7778" x="65.1826" y="4025.9707">last action undone</text></g><path d="M1294,4043.7129 L1294,4160.7129 L1537,4160.7129 L1537,4053.7129 L1527,4043.7129 L1294,4043.7129" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1527,4043.7129 L1527,4053.7129 L1537,4053.7129 L1527,4043.7129" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.5044" x="1300" y="4061.2813">Undo/Redo is time travel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.3135" x="1300" y="4076.5918">to specific sequence number.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1300" y="4091.9023">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.749" x="1300" y="4107.2129">Redo: Navigate to N+1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1300" y="4122.5234">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.5889" x="1300" y="4137.834">Latency budget: &lt; 100ms</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.5552" x="1300" y="4153.1445">(typically &lt; 100 events from cache)</text><path d="M2022,4170.8867 L2022,4241.8867 L2385,4241.8867 L2385,4180.8867 L2375,4170.8867 L2022,4170.8867" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2375,4170.8867 L2375,4180.8867 L2385,4180.8867 L2375,4170.8867" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="101.8418" x="2028" y="4188.4551">Error Handling:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.5625" x="2028" y="4203.7656">- Disk Full: Retry with backoff, enter read-only mode</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.856" x="2028" y="4219.0762">- Corruption: Integrity check on startup, validate JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340.3486" x="2028" y="4234.3867">- Missing Events: Detect sequence gaps, surface error</text><path d="M2369,4252.1289 L2369,4323.1289 L2764,4323.1289 L2764,4262.1289 L2754,4252.1289 L2369,4252.1289" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2754,4252.1289 L2754,4262.1289 L2764,4262.1289 L2754,4252.1289" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="101.8418" x="2375" y="4269.6973">Error Handling:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4697" x="2375" y="4285.0078">- Snapshot Corruption: Fallback to previous snapshot</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374.8989" x="2375" y="4300.3184">- Decompression Error: Warn user, attempt partial recovery</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="359.5947" x="2375" y="4315.6289">- Missing Snapshot: Replay from document start (slower)</text><!--SRC=[lLhRSXf94dtdAp8y4JjW0m9vF0_4U28G89iTRWDelBEX24Ufkq2zQhfx-o8PF_XnFs0_SRzaJzQbBnXipuwqVf3KNLbPbLcPvsHME_LINzBeNWOfhS8iThnWInDl8vszWu4M3S9TvCjKqgKVFj0c3dTqbSYOna6KfPI6j9IHB_QrslVq-X7_GTtwral8zSGs5ZloV3zBqbYaCg7qLf9ZjoNLrXExTJ_VkXVGEo-MwooGSHFgajlmWINmIqzAQCCcfRTnc6rlbTPadwHofwtq0Y_rX4yPM-i5gOo5atfX05LsIYoTC7QXj4c9m7xKNv6C4mzg0aVYTI0YB9pIJWHYAtTOjaaYS36LlTQkVGzrGrZLe_FE-QjMjzlg_8XNlx6ICEXHjzt1urBwa75xv8PESfP44Z-L3UzpUzixjqdzuP8wdPUFVHOrM1x6wjnhaOXJp_4Y0Qy_6uZWNYJmixkLwJF2d_fDLMeTXZvDbGDY9SGlfji3NNruzrwgiUkWlf31sKhwKhdyJAPEkv5FhTLkmW_qJ0Vjqfu1_OLMvX2UqNSJRtkRNlYPh15LbZ6Xpf9cD-Rluu9QlP6q3pM94yGUAXjPnA4ZawIq_9jOok2usg6NH29rRetYul6u-5k43BPu7Ipb5h4LxzKiypOvd3CCdModh4mHDN3cUBVBKd7ZI-r3Z1zOi2XYbYPYpxlI9lmkVUJ8uGAhNoSUKW-P7oOU8cDll1E59xmD6QbarBDw_4odpPHoeF1B3fHJieLYVgNrvfOTYzGbHcMS7wT-U0BiMhpjhqRKHKoUzsZqssYsfkLeC5yEnxCtr9yDQTMVBYPuUFHKLU3S-jaa8lKqMfVm2_7W-9vproGt5i2hExc_2KNiDcfc2YQR1CNiC5Y4Ql8mV0ZEfk6zFBkAwX6_QzIic9dnDV6Qy17A2AlM9fR_p11jUsoCQQGkszjsatOXm5Pjgu4ZLogXskGdj6kyPQtryEOVm8OnC4_58EngKkhjP9926aiHyMBllFGMFF2giqiet90labGZDOSVvPehYrnacmt-s64LJYAuY-4-PPe4sx6gXfeSX4Y1c9E4LHSWmlyMiM4OpKxWcT1jcp6jFz57ifCWEEYnHYH6A0jIpzVxnkeImUupPmX0X574OSvRm8FquJKb2vg84kaIK0YP_0LpBPBbJbM9MMVNzWFdDepLiph0kVAqUlwwuHQ1eTND08TqtagW7tlbKpL2Ybu_dNSwbeVXrqy_s2SZL7_rWH8aDB10AsFtD3upFN1hodmWg1DpFL09A4PZd9kAzt98dJ1_00-dSY7IMsr-ttNBtb0inFZoP83nqeB5SBnQzDU3jmeh-Wj0nQ2_7izdZmuNkIUgNkc3oBO19JfD9GNPxeRvfxuBuVamy1nKO1b7SAEYeY0oA77DGrtguAcLHY5hwGkIo8-xB38lj7WxtKUoKSk5MeVQpGXjia3NPGVgmNAGkZKwdIoEeTLIOvFidghHpDH8rFTzL5ex0UZOXIxYYqICoB8ioWceYKr4Y7P7yFA4OZNA86RtquDKNJ5mKqitw3__-ZVDv8DwoH0r-g2I1-wk11f6kcrw8rEmNdfBDtiQ3tNI62ku38JGUPjqn58W7uZ3bXu0U2HS5nWWb4A8lMpZPDCi3fHONXmeqInokR1K2_6EPY4Ig8NI56VErYfCQjVoZAknLtFdbbRFdOEaPUkKtE6HpShhQxdAeLLZiEHYXhJCuV9ga_d-_idoxmURVulHSZLUhKUpmUY9KouAOQeNWAGrnkR9eeOAaPMCqOru7st70ypywmg0aCiLfHManxFLQBd6h_NSm2foLtSCDgTD2hpdF6jU1_eX4di_561LHnsj-rxmLagg3nSofI0wio39wujt_ObA7DgWQt2pMDnulfVkJGKmLiQM3jIcarcXPBCMmRWsybXys7RBfNgELj_D6Zaht1673CauLibmOg5V9-FrwFtbrMIIInxu7oaKxtNIt0ZdBjniO2YJRfEw7VNhl6Dg0pPIYrTi_2OhB9qp187FOWySkX6UhqPEQE0DzmfRZM0HPAe2P6_66yvhPM3lEk2Q64cD2k6U6ttNpdzsXENppaUJyuYHd-iHjnK6_buTTjEC2UuOI7w8mbX5ARmXuu1nmWyrL1ubyITXrQinNIc4Uz8apajjsEDjzXFLIU50wms4oAMVfUmij8Vt7ay0sh53okMsRKIWuYRpVBUkgI820QLrWAR5JEPQ8zagpfKHr1Vx7CiTtO8_5KQ-GYJD-elLs_cQflrP_yreoeXPHo0Zuf4B7HtJI8L7luP0OkbyKSK7xP0Ng143INLULwKWVhx4ptQxtQXLqy0qawfBKLgcTdgE7A0erJjOqPpfjZ8TL2k8EgktB5Ue7XGCNQ6vYiv2l43rV885zXCp-3uE3K6YeMZxqOiGP9-wdLvNtOdna2gKg_CDY6bKj-sp9eHLpWTsldGl_F2cKSB0lBi-e1PxlNMCNUpOUqIbo3kol7LNM-6wwG0ZYwME4a490ajUh2WrK7dGfkGt2Vnl8bBLVTvaV77Lev_e_DNETXwvjWJdqYFujlMgyyk56Vr5oYX1c0Fpq5sXUr27RFrmj3KhMEWiFt1jk-MQ4sQFyk4l6LsYXwCHCmctz23YGDzJtdbHljsl-ickeGlWC4A7RRPkqJvGNaVlwWXVLP6spHs4Q663p9Oh-LLf-_-7_XglVWH2pWTN2gGcy_vG8PMwsMFKV7oGUlswg74dgANqnVdHgvbv90DgFtWWUhwbfWqEia8BAWgu8CjHXqMuqc-SAFnMeybemC3yjuE411TTBkTJssGVhuDsueE50tfDfUAo301cYKf-ssBIhcOMA-73kxUZvUX0Ydx28jV1V3aSBUdYzyFHuMWrk0ucu-buJTtQSM2mII3IebcTefmji8mk9lEBpyhfeRGI-IQ1OGodYdePWHkVpqbok6O19MbFvildyPnApZ_XZ9zfUjeN_TNWn9bfigNfYovJ1znPpoB-Ip6nD4nSGuSTqINASRv3CZbPjtFAKF_53fxeVsZX3oTL6tFti2Cth6hb-kZ_zcR3fdysd5hGRsNFLwOCieerk1oMi-gg-WWDS0tFNBNUHmnffGXxmHu54vJkgTw5CJZ04GbeekHkkf7fWqHg5xG0uNa9FNlqcoSVL8NiW1SOcI7XYuzx02LNU7o5XiP9twIfxsj52vvpGOuZbruW_CEIusXvgKlARwid6NVAVdmoWBx0eSs6yxFbQ3Ytw3mJzzvMa-GPhRsTf7MCFiL_4ho-2joGmJZM2zO7E_V5tnl7CNkXC4D9K9qdLWlvl2lBC5HldBnWCpSvPRIz3b8H8mxBxz2NTQiwZY3nQR3_1lojprhTncVWck_JQYXjQlhL3LMeuHktmdfFxY9FGelbHtrQnkS2r1aqBWINOIMaBkR_ARJcszaJBls3K5wz3oZWlDNz2dRpwLNxd3-4u1fa-P9jNxb-Ea3XBzpqANWzsWudikYMB8hqK-oO-RaQ_prjo9_6BBTyktaTg2yW-bfA9MGWFsU2_6A3a_biAG45NgA-9V6j5Y07Gt0qVtJtDfvpU2VUhYdtks7FOfRwJZHxqQqTPHXrMSHNmwbc692RUfd_dmHrpyiVUXebp7zqw5MjXUPl9fa-tmJfszv71rZbyF0UvrJv-llyUNKFlUVFyRQbkwLBiEAnEpTK2KUkdjIyGHZ7MQJPTGoXBRgIFS6FpXrncmbmJREeIVS02AuGR9VTegcdFjkRr6CSIQLJgYUtW19qJkNhizBH5EOLtw1FMvSZMNcxbmW3Df031pNflHTcIRb9QvNALGvbS-Ft3asT-kyfJU8xfLsKwi_ambVj5j_7LEopQ_TCxwDZhLmse1wf9sXN-BDERk5_0G00]--></g></svg>