[
  {
    "task_id": "I4.T1",
    "iteration_id": "I4",
    "iteration_goal": "Finalize multi-artboard persistence, navigator tabs, per-artboard state isolation, window lifecycle, collaboration gateway MVP, and history replay UI.",
    "description": "Extend domain + persistence layers for multi-artboard (list of artboards, per-artboard layers, viewport/selection state) with migrations and version bump to v2.0.0.",
    "agent_type_hint": "DatabaseAgent",
    "inputs": "FR-029–FR-045, ADR-005.",
    "target_files": [],
    "input_files": [],
    "deliverables": "Updated models, migration scripts, ADR, tests covering serialization & replay.",
    "acceptance_criteria": "Migration converts single artboard docs; events carry artboardId; snapshots validated; version constant bumped.",
    "dependencies": [
      "I3.T1",
      "I3.T3"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I4.T2",
    "iteration_id": "I4",
    "iteration_goal": "Finalize multi-artboard persistence, navigator tabs, per-artboard state isolation, window lifecycle, collaboration gateway MVP, and history replay UI.",
    "description": "Implement navigator thumbnail pipeline (auto-refresh, save-triggered refresh, manual refresh action) with background worker + caching.",
    "agent_type_hint": "FrontendAgent",
    "inputs": "FR-039, Section 7.5.",
    "target_files": [],
    "input_files": [],
    "deliverables": "Thumbnail worker, caching policy, tests ensuring idle/refresh triggers.",
    "acceptance_criteria": "Updates after 10s idle or save; manual refresh command; caches per artboard; telemetry emits `thumbnail.refresh.age`.",
    "dependencies": [
      "I4.T1"
    ],
    "parallelizable": true,
    "done": false
  },
  {
    "task_id": "I4.T3",
    "iteration_id": "I4",
    "iteration_goal": "Finalize multi-artboard persistence, navigator tabs, per-artboard state isolation, window lifecycle, collaboration gateway MVP, and history replay UI.",
    "description": "Deliver full history replay UI + ReplayService checkpoint cache, including scrubber, playback controls, speed adjustments, and preview rendering.",
    "agent_type_hint": "FrontendAgent",
    "inputs": "ADR-006, Flow J, FR-027.",
    "target_files": [],
    "input_files": [],
    "deliverables": "Checkpoint cache, timeline UI, playback logic, tests for seek latency.",
    "acceptance_criteria": "Checkpoints every 1k events; <50 ms seek target; UI supports 0.5×–10× speeds; telemetry instrumentation added.",
    "dependencies": [
      "I2.T3",
      "I3.T1"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I4.T4",
    "iteration_id": "I4",
    "iteration_goal": "Finalize multi-artboard persistence, navigator tabs, per-artboard state isolation, window lifecycle, collaboration gateway MVP, and history replay UI.",
    "description": "Implement collaboration gateway MVP (Dart Frog) with WebSocket OT channel, GraphQL presence subscription fallback, Redis pub/sub integration, and client CollaborationClient.",
    "agent_type_hint": "BackendAgent",
    "inputs": "ADR-002, Section 7.9.",
    "target_files": [],
    "input_files": [],
    "deliverables": "WebSocket server, OT transformer library, client integration.",
    "acceptance_criteria": "Handles ≥10 concurrent editors; OT tests cover anchor/object operations; presence updates propagate; security enforced (JWT validation).",
    "dependencies": [
      "I2.T2",
      "I3.T1"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I4.T5",
    "iteration_id": "I4",
    "iteration_goal": "Finalize multi-artboard persistence, navigator tabs, per-artboard state isolation, window lifecycle, collaboration gateway MVP, and history replay UI.",
    "description": "Build collaboration UI (presence panel, live cursors, conflict banners) with accessibility cues, latency indicators, and offline fallback messaging.",
    "agent_type_hint": "FrontendAgent",
    "inputs": "Section 6 (presence components), Flow I.",
    "target_files": [],
    "input_files": [],
    "deliverables": "UI modules, hooking into CollaborationClient events, tests for offline fallback.",
    "acceptance_criteria": "Presence panel updates in <500 ms; cursors respect color palette; conflict banner actions wired.",
    "dependencies": [
      "I4.T4"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I4.T6",
    "iteration_id": "I4",
    "iteration_goal": "Finalize multi-artboard persistence, navigator tabs, per-artboard state isolation, window lifecycle, collaboration gateway MVP, and history replay UI.",
    "description": "Implement window lifecycle manager (Navigator root, artboard windows, close prompts, per-window state persistence) and update platform integrations (QuickLook/Explorer hooks).",
    "agent_type_hint": "FrontendAgent",
    "inputs": "Journey 10–18, FR-040, FR-047, FR-048.",
    "target_files": [],
    "input_files": [],
    "deliverables": "Window manager, prompts, platform thumbnail generators.",
    "acceptance_criteria": "Closing Navigator prompts to close document; artboard windows reopen with viewport state; macOS QuickLook & Windows Explorer show thumbnails; tests simulate lifecycle events.",
    "dependencies": [
      "I3.T2",
      "I3.T3"
    ],
    "parallelizable": true,
    "done": false
  }
]