[
  {
    "task_id": "I8.T1",
    "iteration_id": "I8",
    "iteration_goal": "Implement dragging capabilities for anchor points, BCP handles, and objects; add multi-selection support",
    "description": "Enhance DirectSelectionTool (from I5.T5) to support full anchor point dragging workflow. Implement drag state machine: IDLE → DRAGGING_ANCHOR → IDLE. Generate MoveAnchorEvent sampled at 50ms during drag. Update anchor position in real-time (via event application). Handle edge cases (anchor at path boundary, closed vs open paths). Write comprehensive integration tests.",
    "agent_type_hint": "BackendAgent",
    "inputs": "Architecture blueprint Section 4.4 (Sequence Diagram - Dragging anchor)\nTicket T029 (Anchor Point Dragging)",
    "target_files": [
      "lib/application/tools/direct_selection_tool.dart"
    ],
    "input_files": [
      "lib/application/tools/direct_selection_tool.dart"
    ],
    "deliverables": "Anchor dragging with 50ms sampling\nReal-time visual feedback during drag\nMoveAnchorEvent recording\nIntegration tests for drag workflow",
    "acceptance_criteria": "Drag anchor updates position smoothly at ~20 FPS (50ms sampling)\nMoveAnchorEvent generated every 50ms during drag\nFinal position recorded on pointer up\nAnchor stays attached to path\nIntegration test drags anchor 100px and verifies position",
    "dependencies": [
      "I5.T5",
      "I2.T2"
    ],
    "parallelizable": true,
    "done": false
  },
  {
    "task_id": "I8.T2",
    "iteration_id": "I8",
    "iteration_goal": "Implement dragging capabilities for anchor points, BCP handles, and objects; add multi-selection support",
    "description": "Implement BCP handle dragging in DirectSelectionTool. When anchor selected, render BCP handles as draggable points. Dragging handle generates ModifyAnchorEvent (updates handleIn or handleOut). Support anchor type constraints: smooth anchors maintain symmetric handles, corner anchors allow independent handles. Write integration tests for handle manipulation.",
    "agent_type_hint": "BackendAgent",
    "inputs": "Ticket T030 (BCP Handle Dragging)\nAnchorPoint model from I3.T2",
    "target_files": [
      "lib/application/tools/direct_selection_tool.dart"
    ],
    "input_files": [
      "lib/application/tools/direct_selection_tool.dart"
    ],
    "deliverables": "BCP handle dragging with ModifyAnchorEvent\nAnchor type constraints enforced (smooth = symmetric, corner = independent)\nReal-time curve preview during drag\nIntegration tests",
    "acceptance_criteria": "Dragging handleOut updates curve shape\nSmooth anchor: handleIn updates symmetrically\nCorner anchor: handles move independently\nModifyAnchorEvent recorded at 50ms intervals\nIntegration test adjusts handle and verifies curve",
    "dependencies": [
      "I8.T1",
      "I3.T2"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I8.T3",
    "iteration_id": "I8",
    "iteration_goal": "Implement dragging capabilities for anchor points, BCP handles, and objects; add multi-selection support",
    "description": "Enhance SelectionTool (from I5.T4) to support full object dragging workflow. Implement DRAGGING_OBJECT state. Generate MoveObjectEvent sampled at 50ms during drag. Update object transform (translation) in real-time. Support dragging multiple selected objects simultaneously. Write integration tests for single and multi-object drag.",
    "agent_type_hint": "BackendAgent",
    "inputs": "Ticket T031 (Object Dragging)",
    "target_files": [
      "lib/application/tools/selection_tool.dart"
    ],
    "input_files": [
      "lib/application/tools/selection_tool.dart"
    ],
    "deliverables": "Object dragging with 50ms sampling\nTransform.translate() applied during drag\nMulti-object drag support\nIntegration tests",
    "acceptance_criteria": "Drag object updates position smoothly\nMoveObjectEvent generated every 50ms\nMultiple selected objects move together maintaining relative positions\nIntegration test drags rectangle 50px right and verifies transform",
    "dependencies": [
      "I5.T4",
      "I3.T1"
    ],
    "parallelizable": true,
    "done": false
  },
  {
    "task_id": "I8.T4",
    "iteration_id": "I8",
    "iteration_goal": "Implement dragging capabilities for anchor points, BCP handles, and objects; add multi-selection support",
    "description": "Implement multi-selection support in SelectionTool. Shift+Click adds object to selection without clearing existing selection. Cmd+Click (macOS) or Ctrl+Click (Windows) toggles object in selection. Update Selection model to support multiple object IDs. Render bounding box encompassing all selected objects. Write integration tests for multi-selection scenarios.",
    "agent_type_hint": "BackendAgent",
    "inputs": "Ticket T032 (Multi-Selection Support)",
    "target_files": [
      "lib/application/tools/selection_tool.dart"
    ],
    "input_files": [
      "lib/application/tools/selection_tool.dart"
    ],
    "deliverables": "Shift+Click adds to selection\nCmd/Ctrl+Click toggles selection\nBounding box for multiple selected objects\nIntegration tests",
    "acceptance_criteria": "Shift+Click adds object without clearing selection\nCmd/Ctrl+Click toggles object selection state\nSelection model stores multiple object IDs\nBounding box encompasses all selected objects\nIntegration test selects 3 objects and drags them together",
    "dependencies": [
      "I8.T3",
      "I3.T6"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I8.T5",
    "iteration_id": "I8",
    "iteration_goal": "Implement dragging capabilities for anchor points, BCP handles, and objects; add multi-selection support",
    "description": "Implement undo/redo functionality accessible via Cmd+Z (undo) and Cmd+Shift+Z (redo) on macOS, Ctrl+Z and Ctrl+Shift+Z on Windows. Create EventNavigator service in `lib/infrastructure/event_sourcing/event_navigator.dart` that uses EventReplayer to reconstruct state at target event sequence. Integrate with keyboard shortcuts. Write integration tests for undo/redo workflow (create object, move it, undo move, redo move).",
    "agent_type_hint": "BackendAgent",
    "inputs": "Architecture blueprint Section 4.4 (Sequence Diagram - Undo operation)\nArchitecture blueprint Section 5.2 (Future - Undo/Redo UI design)",
    "target_files": [
      "lib/infrastructure/event_sourcing/event_navigator.dart",
      "lib/application/services/keyboard_shortcut_service.dart",
      "integration_test/undo_redo_test.dart"
    ],
    "input_files": [
      "lib/infrastructure/event_sourcing/event_replayer.dart"
    ],
    "deliverables": "EventNavigator service with undo(), redo(), canUndo(), canRedo()\nKeyboard shortcut handling (Cmd/Ctrl+Z, Cmd/Ctrl+Shift+Z)\nIntegration with DocumentProvider\nIntegration tests for undo/redo",
    "acceptance_criteria": "Cmd/Ctrl+Z undoes last action (navigates to previous event sequence)\nCmd/Ctrl+Shift+Z redoes undone action (navigates forward)\ncanUndo() returns false when at beginning of history\ncanRedo() returns false when at latest event\nIntegration test: create rectangle, move it, undo, redo, verify positions",
    "dependencies": [
      "I2.T9"
    ],
    "parallelizable": true,
    "done": false
  }
]