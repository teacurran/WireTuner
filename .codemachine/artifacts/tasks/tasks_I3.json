[
  {
    "task_id": "I3.T1",
    "iteration_id": "I3",
    "iteration_goal": "Implement immutable domain models for vector objects (Document, Path, Shape, Segment, AnchorPoint, Style, Transform) with comprehensive unit tests",
    "description": "Implement core geometry primitives in `lib/domain/models/`: Point (x, y), Rectangle (bounds), Matrix4 wrapper for transforms. Use vector_math package. Make all classes immutable with const constructors where possible. Write extensive unit tests for geometric operations (distance, intersection, transformation).",
    "agent_type_hint": "BackendAgent",
    "inputs": "Architecture blueprint Section 3.6 (Data Model - Geometry primitives)\nTicket T009 (Core Geometry Primitives)",
    "target_files": [
      "lib/domain/models/geometry/point.dart",
      "lib/domain/models/geometry/rectangle.dart",
      "lib/domain/models/transform.dart",
      "test/domain/models/geometry/geometry_test.dart"
    ],
    "input_files": [],
    "deliverables": "Immutable Point, Rectangle classes\nTransform class wrapping Matrix4\nUnit tests achieving 90%+ coverage",
    "acceptance_criteria": "All classes are immutable (@immutable annotation)\nPoint supports arithmetic operations (add, subtract, distance)\nRectangle supports intersection, union, containsPoint\nTransform supports translate, rotate, scale, composition\nUnit tests verify all operations with edge cases",
    "dependencies": [
      "I1.T1"
    ],
    "parallelizable": true,
    "done": false
  },
  {
    "task_id": "I3.T2",
    "iteration_id": "I3",
    "iteration_goal": "Implement immutable domain models for vector objects (Document, Path, Shape, Segment, AnchorPoint, Style, Transform) with comprehensive unit tests",
    "description": "Implement AnchorPoint and Segment models in `lib/domain/models/`. AnchorPoint has position, optional handleIn/handleOut (BCPs), and anchorType enum (corner/smooth/symmetric). Segment connects two anchors with type (line/bezier/arc). Both immutable with copyWith() methods. Write unit tests.",
    "agent_type_hint": "BackendAgent",
    "inputs": "Architecture blueprint Section 3.6 (Data Model - AnchorPoint, Segment)\nTicket T010 (Path Data Model)",
    "target_files": [
      "lib/domain/models/anchor_point.dart",
      "lib/domain/models/segment.dart",
      "test/domain/models/anchor_point_test.dart",
      "test/domain/models/segment_test.dart"
    ],
    "input_files": [
      "lib/domain/models/geometry/point.dart"
    ],
    "deliverables": "Immutable AnchorPoint class with BCP handles\nSegment class with line/bezier/arc types\ncopyWith() methods for immutable updates\nUnit tests for anchor types and segment construction",
    "acceptance_criteria": "AnchorPoint correctly represents corner, smooth, symmetric types\nSegment stores correct anchor references and control points\ncopyWith() creates new instances with modified fields\nUnit tests achieve 85%+ coverage",
    "dependencies": [
      "I3.T1"
    ],
    "parallelizable": true,
    "done": false
  },
  {
    "task_id": "I3.T3",
    "iteration_id": "I3",
    "iteration_goal": "Implement immutable domain models for vector objects (Document, Path, Shape, Segment, AnchorPoint, Style, Transform) with comprehensive unit tests",
    "description": "Implement Path model in `lib/domain/models/path.dart`. Path contains list of Segments, closed boolean flag. Provide methods: bounds(), length(), pointAt(t), addSegment(). Make immutable with copyWith(). Write unit tests including Bezier curve paths.",
    "agent_type_hint": "BackendAgent",
    "inputs": "Architecture blueprint Section 3.6 (Data Model - Path)\nTicket T010 (Path Data Model)",
    "target_files": [
      "lib/domain/models/path.dart",
      "test/domain/models/path_test.dart"
    ],
    "input_files": [
      "lib/domain/models/segment.dart"
    ],
    "deliverables": "Immutable Path class with segment list\nbounds() calculates bounding rectangle\nlength() computes total path length\npointAt(t) returns point along path at parameter t [0-1]\nUnit tests with straight and curved paths",
    "acceptance_criteria": "Path correctly stores segments and closed state\nbounds() accurate for Bezier curves (use control point bounds initially)\nlength() approximates arc length for curves\nUnit tests cover open/closed paths, straight/curved segments",
    "dependencies": [
      "I3.T2"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I3.T4",
    "iteration_id": "I3",
    "iteration_goal": "Implement immutable domain models for vector objects (Document, Path, Shape, Segment, AnchorPoint, Style, Transform) with comprehensive unit tests",
    "description": "Implement Style model in `lib/domain/models/style.dart` for fill/stroke properties. Include fill color, stroke color, stroke width, opacity, blend mode. Make immutable. Implement Shape model in `lib/domain/models/shape.dart` with ShapeType enum (rect, ellipse, polygon, star) and parameters map. Shape has toPath() method to generate Path representation. Write unit tests for all shape types.",
    "agent_type_hint": "BackendAgent",
    "inputs": "Architecture blueprint Section 3.6 (Data Model - Style, Shape)\nTicket T011 (Shape Data Model)",
    "target_files": [
      "lib/domain/models/style.dart",
      "lib/domain/models/shape.dart",
      "test/domain/models/style_test.dart",
      "test/domain/models/shape_test.dart"
    ],
    "input_files": [
      "lib/domain/models/path.dart"
    ],
    "deliverables": "Immutable Style class with paint properties\nShape class with parametric definitions\ntoPath() implementations for rect, ellipse, polygon, star\nUnit tests verifying shape-to-path conversion",
    "acceptance_criteria": "Style stores all paint properties\nShape.toPath() generates correct Path for each ShapeType\nRectangle shape produces 4-segment closed path\nEllipse shape produces Bezier approximation\nPolygon shape produces n-sided regular polygon\nStar shape produces n-pointed star with inner/outer radii\nUnit tests cover all shape types and edge cases",
    "dependencies": [
      "I3.T3"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I3.T5",
    "iteration_id": "I3",
    "iteration_goal": "Implement immutable domain models for vector objects (Document, Path, Shape, Segment, AnchorPoint, Style, Transform) with comprehensive unit tests",
    "description": "Implement VectorObject abstract base class and Layer model in `lib/domain/models/`. VectorObject has id, transform, style, and abstract methods bounds(), hitTest(). Layer has id, name, visible, locked, and list of VectorObjects. Make both immutable. Update Path and Shape to extend VectorObject. Write unit tests.",
    "agent_type_hint": "BackendAgent",
    "inputs": "Architecture blueprint Section 3.6 (Data Model - VectorObject, Layer)",
    "target_files": [
      "lib/domain/models/vector_object.dart",
      "lib/domain/models/layer.dart",
      "lib/domain/models/path.dart"
    ],
    "input_files": [
      "lib/domain/models/path.dart"
    ],
    "deliverables": "VectorObject abstract base class\nPath and Shape extending VectorObject\nLayer model with object list\nUnit tests for layer operations (add, remove, reorder objects)",
    "acceptance_criteria": "VectorObject defines common interface for all drawable objects\nPath.bounds() accounts for transform matrix\nShape.bounds() computed from generated path\nLayer correctly manages object list\nUnit tests verify polymorphism (Layer can hold Path or Shape)",
    "dependencies": [
      "I3.T3",
      "I3.T4"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I3.T6",
    "iteration_id": "I3",
    "iteration_goal": "Implement immutable domain models for vector objects (Document, Path, Shape, Segment, AnchorPoint, Style, Transform) with comprehensive unit tests",
    "description": "Implement Document model in `lib/domain/models/document.dart` as root aggregate. Contains list of Layers, Selection, Viewport. Provide query methods: getObjectById(), getAllObjects(), getObjectsInBounds(). Make immutable with copyWith(). Write comprehensive unit tests including complex documents with nested objects.",
    "agent_type_hint": "BackendAgent",
    "inputs": "Architecture blueprint Section 3.6 (Data Model - Document)\nArchitecture blueprint Section 4.6 (Internal API - Document State)\nTicket T012 (Document Model)",
    "target_files": [
      "lib/domain/models/document.dart",
      "lib/domain/models/selection.dart",
      "lib/domain/models/viewport.dart",
      "test/domain/models/document_test.dart"
    ],
    "input_files": [
      "lib/domain/models/layer.dart"
    ],
    "deliverables": "Immutable Document class with layer hierarchy\nSelection model (set of object IDs, anchor indices)\nViewport model (pan, zoom, canvas size)\nQuery methods (getObjectById, getAllObjects, getObjectsInBounds)\nUnit tests with multi-layer documents",
    "acceptance_criteria": "Document correctly manages layer list\ngetObjectById() searches across all layers\ngetAllObjects() flattens layer hierarchy\ngetObjectsInBounds() uses bounds() for filtering\nSelection tracks object IDs and anchor indices\nViewport supports pan/zoom transformations\nUnit tests achieve 90%+ coverage for Document class",
    "dependencies": [
      "I3.T5"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I3.T7",
    "iteration_id": "I3",
    "iteration_goal": "Implement immutable domain models for vector objects (Document, Path, Shape, Segment, AnchorPoint, Style, Transform) with comprehensive unit tests",
    "description": "Generate PlantUML ERD diagram in `docs/diagrams/database_erd.puml` showing SQLite schema (metadata, events, snapshots tables) with relationships and field types. Also generate PlantUML Class Diagram in `docs/diagrams/domain_model_class.puml` showing in-memory domain model (Document, Layer, VectorObject hierarchy, Path, Shape, Segment, AnchorPoint, Style, Transform). Both diagrams should match implemented models.",
    "agent_type_hint": "DocumentationAgent",
    "inputs": "Architecture blueprint Section 3.6 (Data Model ERD)\nImplemented domain models from I3.T1-I3.T6\nDatabase schema from I1.T5",
    "target_files": [
      "docs/diagrams/database_erd.puml",
      "docs/diagrams/domain_model_class.puml"
    ],
    "input_files": [
      "lib/domain/models/*.dart"
    ],
    "deliverables": "PlantUML ERD diagram for SQLite schema\nPlantUML Class Diagram for domain model\nBoth diagrams render without syntax errors",
    "acceptance_criteria": "ERD accurately reflects metadata, events, snapshots tables with primary/foreign keys\nClass diagram shows inheritance (VectorObject â†’ Path, Shape)\nClass diagram shows composition (Document contains Layers, Layer contains VectorObjects)\nDiagrams validate and render correctly",
    "dependencies": [
      "I3.T6"
    ],
    "parallelizable": true,
    "done": false
  }
]