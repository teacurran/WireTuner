[
  {
    "task_id": "I1.T1",
    "iteration_id": "I1",
    "iteration_goal": "Establish the Flutter desktop workspace, wire up SQLite persistence, and deliver the initial event-sourcing backbone (modeling, recording, persistence, replay) plus baseline architecture artifacts.",
    "description": "Initialize the Flutter desktop project, configure analysis/lint rules, set up CI skeleton, and document build/run guidelines referencing T001.",
    "agent_type_hint": "SetupAgent",
    "inputs": "Section 1 overview, existing architecture blueprint (`thoughts/shared/...`), Flutter tooling guides.",
    "target_files": [
      "pubspec.yaml",
      "analysis_options.yaml",
      "README.md",
      ".github/workflows/ci.yml",
      "lib/main.dart"
    ],
    "input_files": [
      "README.md",
      "pubspec.yaml",
      "analysis_options.yaml",
      ".github/workflows"
    ],
    "deliverables": "Flutter desktop scaffold with macOS/Windows targets enabled, CI workflow stub, contributor guide snippet for setup.",
    "acceptance_criteria": "- `flutter doctor` passes locally; README documents prerequisites and commands.\n        - CI workflow runs `flutter analyze` + `flutter test` on push.\n        - Analyzer enforces null-safety, immutability hints, and forbids `print` debugging in lib/.",
    "dependencies": [],
    "parallelizable": true,
    "done": true
  },
  {
    "task_id": "I1.T2",
    "iteration_id": "I1",
    "iteration_goal": "Establish the Flutter desktop workspace, wire up SQLite persistence, and deliver the initial event-sourcing backbone (modeling, recording, persistence, replay) plus baseline architecture artifacts.",
    "description": "Integrate SQLite via `sqflite_common_ffi`, create persistence service scaffold, and capture the Component Diagram (PlantUML) covering UI shell, event core, vector engine, and persistence (T002, Section 2 key components).",
    "agent_type_hint": "BackendAgent",
    "inputs": "Sections 2 & 2.1, Dissipate reference repo for patterns.",
    "target_files": [
      "lib/src/event_sourcing/persistence/sqlite_repository.dart",
      "docs/diagrams/component_overview.puml"
    ],
    "input_files": [
      "pubspec.yaml",
      "lib/src/event_sourcing/persistence/",
      "docs/diagrams/"
    ],
    "deliverables": "SQLite repository wrapper with open/close migrations, dependency injection hooks, and PlantUML component diagram checked into docs.",
    "acceptance_criteria": "- Repository exposes CRUD helpers for metadata, events, snapshots, returning Futures.\n        - Diagram renders without syntax errors (tested via `./tools/scripts/render_diagram.sh`).\n        - Unit tests mock FFI driver to validate database path selection per platform.",
    "dependencies": [
      "I1.T1"
    ],
    "parallelizable": true,
    "done": true
  },
  {
    "task_id": "I1.T3",
    "iteration_id": "I1",
    "iteration_goal": "Establish the Flutter desktop workspace, wire up SQLite persistence, and deliver the initial event-sourcing backbone (modeling, recording, persistence, replay) plus baseline architecture artifacts.",
    "description": "Formalize the event sourcing architecture (T003) by detailing event lifecycle documentation and producing the Event Flow Sequence diagram showing recorder, sampler, dispatcher, snapshot manager, and undo navigator interactions.",
    "agent_type_hint": "DocumentationAgent",
    "inputs": "Sections 2 & 2.1, `docs/diagrams/component_overview.puml`.",
    "target_files": [
      "docs/diagrams/event_flow_sequence.puml",
      "docs/specs/event_lifecycle.md"
    ],
    "input_files": [
      "docs/diagrams/component_overview.puml",
      "docs/diagrams/"
    ],
    "deliverables": "PlantUML sequence diagram, Markdown explainer describing sampling cadence, snapshot cadence, and failure handling.",
    "acceptance_criteria": "- Diagram compiles; Markdown cross-links to relevant tickets (T003–T008) and includes latency budgets.\n        - Document enumerates responsibilities per component and outlines error handling (disk full, corruption) per requirement notes.\n        - Reviewed by backend lead (self-review) and referenced by subsequent tasks.",
    "dependencies": [
      "I1.T1",
      "I1.T2"
    ],
    "parallelizable": true,
    "done": true
  },
  {
    "task_id": "I1.T4",
    "iteration_id": "I1",
    "iteration_goal": "Establish the Flutter desktop workspace, wire up SQLite persistence, and deliver the initial event-sourcing backbone (modeling, recording, persistence, replay) plus baseline architecture artifacts.",
    "description": "Define the event model (T004) as immutable classes/enums via Freezed, covering pen, shape, selection, and file ops actions with JSON serialization helpers.",
    "agent_type_hint": "BackendAgent",
    "inputs": "Event lifecycle doc, Sections 2 & 2.1.",
    "target_files": [
      "lib/src/event_sourcing/model/document_event.dart",
      "lib/src/event_sourcing/model/event_type.dart"
    ],
    "input_files": [
      "lib/src/event_sourcing/model/",
      "pubspec.yaml"
    ],
    "deliverables": "Freezed models + generated `.g.dart` files, registry of event type constants, basic validation utilities.",
    "acceptance_criteria": "- Covers events for create path, add anchor, move object, shape creation, viewport, save/load markers.\n        - Round-trip JSON serialization tests succeed; invalid payloads throw meaningful errors.\n        - Documentation comments map each event to ticket IDs for traceability.",
    "dependencies": [
      "I1.T3"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I1.T5",
    "iteration_id": "I1",
    "iteration_goal": "Establish the Flutter desktop workspace, wire up SQLite persistence, and deliver the initial event-sourcing backbone (modeling, recording, persistence, replay) plus baseline architecture artifacts.",
    "description": "Implement the event recorder with 50 ms sampler and buffering (T005), tying into Provider notifications and logger hooks.",
    "agent_type_hint": "BackendAgent",
    "inputs": "Event model, event flow doc.",
    "target_files": [
      "lib/src/event_sourcing/recorder/event_recorder.dart",
      "lib/src/event_sourcing/recorder/event_sampler.dart",
      "test/unit/event_recorder_test.dart"
    ],
    "input_files": [
      "lib/src/event_sourcing/recorder/",
      "lib/src/event_sourcing/model/"
    ],
    "deliverables": "Recorder service with pause/resume/flush APIs, 50 ms throttling, and unit tests simulating drag events.",
    "acceptance_criteria": "- Sampler reduces >90% of redundant move events in tests.\n        - Recorder writes batches to repository mock and emits ChangeNotifier updates.\n        - Logger emits WARN if queue backpressure exceeds configurable threshold.",
    "dependencies": [
      "I1.T4"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I1.T6",
    "iteration_id": "I1",
    "iteration_goal": "Establish the Flutter desktop workspace, wire up SQLite persistence, and deliver the initial event-sourcing backbone (modeling, recording, persistence, replay) plus baseline architecture artifacts.",
    "description": "Build event log persistence and snapshot manager scaffolding (T006, T007) with transactional writes and configurable snapshot cadence.",
    "agent_type_hint": "BackendAgent",
    "inputs": "SQLite repo (`I1.T2`), event model (`I1.T4`).",
    "target_files": [
      "lib/src/event_sourcing/persistence/event_store.dart",
      "lib/src/event_sourcing/snapshots/snapshot_manager.dart",
      "test/unit/snapshot_manager_test.dart"
    ],
    "input_files": [
      "lib/src/event_sourcing/persistence/",
      "lib/src/event_sourcing/snapshots/",
      "test/unit/"
    ],
    "deliverables": "EventStore abstraction with append/query APIs, SnapshotManager storing compressed blobs every 1,000 events, unit tests with in-memory SQLite.",
    "acceptance_criteria": "- ACID-safe writes validated via transaction tests; WAL mode enabled on desktop.\n        - Snapshot creation under 25 ms for 1k anchors sample dataset.\n        - Manager exposes hooks for telemetry (events per snapshot, compression ratio).",
    "dependencies": [
      "I1.T2",
      "I1.T4"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I1.T7",
    "iteration_id": "I1",
    "iteration_goal": "Establish the Flutter desktop workspace, wire up SQLite persistence, and deliver the initial event-sourcing backbone (modeling, recording, persistence, replay) plus baseline architecture artifacts.",
    "description": "Implement the event replay engine and undo/redo navigator (T008) capable of loading from latest snapshot, replaying deltas, and navigating to arbitrary sequence numbers.",
    "agent_type_hint": "BackendAgent",
    "inputs": "EventStore & SnapshotManager, event flow sequence diagram.",
    "target_files": [
      "lib/src/event_sourcing/replayer/event_replayer.dart",
      "lib/src/event_sourcing/replayer/event_navigator.dart",
      "test/unit/event_replayer_test.dart",
      "test/unit/event_navigator_test.dart"
    ],
    "input_files": [
      "lib/src/event_sourcing/replayer/",
      "lib/src/event_sourcing/model/",
      "test/unit/"
    ],
    "deliverables": "Replay service with async generators, navigator managing undo/redo stacks via sequence index, regression tests covering corrupted event handling.",
    "acceptance_criteria": "- Replay 5k-event fixture under 200 ms on CI runner.\n        - Navigator gracefully skips gaps/corrupt events with logged warnings.\n        - API documented for consumers (tools, save/load) with sample usage snippet.",
    "dependencies": [
      "I1.T5",
      "I1.T6"
    ],
    "parallelizable": false,
    "done": false
  }
]